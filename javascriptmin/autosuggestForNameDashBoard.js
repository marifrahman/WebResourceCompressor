var ID;var Pos;function AutoSuggestControl(b,a){this.cur=-1;this.layer=null;this.provider=a;this.textbox=b;this.init()}AutoSuggestControl.prototype.autosuggest=function(a,f,g,b){ID=f;Pos=g;if(document.getElementById("nameSearch")){document.getElementById("nameSearch").disabled=false;if(document.getElementById("nameSearch")!="Select One"&&document.getElementById("nameSearch")!="Show All"){var e=document.getElementById("nameSearch");for(var d=0;d<e.length;d++){if(e[d].value=="Select One"||e[d].value=="Show All"){e[d].selected=true;break}}}}var c=document.getElementById("nameSearch").value;if(c.length<=2){document.getElementById("lenWarning").style.visibility="";document.getElementById("nameSearchID").innerHTML="";this.hideSuggestions();return}if(c.replace(/^\s+|\s+$/g,"")==""){document.getElementById("lenWarning").style.visibility="";document.getElementById("nameSearchID").innerHTML="";this.hideSuggestions();return}document.getElementById("lenWarning").style.visibility="hidden";if(a.length>1){if(b){this.typeAhead(a[0])}if(a.length-1==1){document.getElementById("nameSearchID").innerHTML=ID[0]}else{if(a.length-1==0){document.getElementById("nameSearchID").innerHTML="";document.getElementById("errorMessage").value="Employee not found"}else{if(a.length-1>1){document.getElementById("nameSearchID").innerHTML="";document.getElementById("errorMessage").value="Please select a name from the list"}}}this.showSuggestions(a)}else{this.hideSuggestions()}};AutoSuggestControl.prototype.createDropDown=function(){var a=this;this.layer=document.createElement("div");this.layer.className="suggestions";this.layer.style.visibility="hidden";this.layer.style.width=this.textbox.offsetWidth;this.layer.onmousedown=this.layer.onmouseup=this.layer.onmouseover=function(c){c=c||window.event;oTarget=c.target||c.srcElement;if(c.type=="mousedown"){a.textbox.value=oTarget.firstChild.nodeValue;for(var b=0;b<a.layer.childNodes.length;b++){var d=a.layer.childNodes[b];if(d==oTarget){document.getElementById("nameSearchID").innerHTML=ID[b]}}a.hideSuggestions()}else{if(c.type=="mouseover"){a.highlightSuggestion(oTarget)}else{a.textbox.focus()}}};document.body.appendChild(this.layer)};AutoSuggestControl.prototype.getLeft=function(){var c=this.textbox;var b=0;try{while(c.tagName!="BODY"){b+=c.offsetLeft;c=c.offsetParent}}catch(a){}return b};AutoSuggestControl.prototype.getTop=function(){var c=this.textbox;var b=0;try{while(c.tagName!="BODY"){b+=c.offsetTop;c=c.offsetParent}}catch(a){}return b};AutoSuggestControl.prototype.handleKeyDown=function(b){switch(b.keyCode){case 38:this.previousSuggestion();break;case 40:this.nextSuggestion();break;case 13:if(document.getElementById("formAdmin")){document.getElementById("formAdmin").action="CusProEditInducteeDisplay.asp?temp=ExistingInductee&search=Generate"}oTarget=b.target||b.srcElement;for(var a=0;a<this.layer.childNodes.length;a++){var c=this.layer.childNodes[a];if(c.firstChild.nodeValue==oTarget.value){document.getElementById("nameSearchID").innerHTML=ID[a]}}document.getElementById("searchName").value=document.getElementById("nameSearch").value;if(document.getElementById("formAdmin")){document.getElementById("formAdmin").submit()}else{submitform()}break}};AutoSuggestControl.prototype.handleKeyUp=function(b){var a=b.keyCode;if(a==8||a==46){this.provider.requestSuggestions(this,false)}else{if(a<32||(a>=33&&a<46)||(a>=112&&a<=123)){}else{this.provider.requestSuggestions(this,false)}}};AutoSuggestControl.prototype.hideSuggestions=function(){this.layer.style.visibility="hidden"};AutoSuggestControl.prototype.highlightSuggestion=function(c){for(var a=0;a<this.layer.childNodes.length;a++){var b=this.layer.childNodes[a];if(b==c){b.className="current"}else{if(b.className=="current"){b.className=""}}}};AutoSuggestControl.prototype.init=function(){var a=this;this.textbox.onkeyup=function(b){if(!b){b=window.event}a.handleKeyUp(b)};this.textbox.onkeydown=function(b){if(!b){b=window.event}a.handleKeyDown(b)};this.textbox.onblur=function(){if(document.getElementById("showAlert").value=="false"){a.hideSuggestions()}};this.createDropDown()};AutoSuggestControl.prototype.nextSuggestion=function(){var a=this.layer.childNodes;if(a.length>0&&this.cur<a.length-1){var b=a[++this.cur];this.highlightSuggestion(b);this.textbox.value=b.firstChild.nodeValue}};AutoSuggestControl.prototype.previousSuggestion=function(){var a=this.layer.childNodes;if(a.length>0&&this.cur>0){var b=a[--this.cur];this.highlightSuggestion(b);this.textbox.value=b.firstChild.nodeValue}};AutoSuggestControl.prototype.selectRange=function(b,a){if(this.textbox.createTextRange){var c=this.textbox.createTextRange();c.moveStart("character",b);c.moveEnd("character",a-this.textbox.value.length);c.select()}else{if(this.textbox.setSelectionRange){this.textbox.setSelectionRange(b,a)}}this.textbox.focus()};AutoSuggestControl.prototype.showSuggestions=function(a){var d=null;var c=null;this.layer.innerHTML="";if(a.length<1){this.hideSuggestions()}for(var b=0;b<a.length;b++){d=document.createElement("div");d.appendChild(document.createTextNode(a[b]));this.layer.appendChild(d)}this.layer.style.left=this.getLeft()+"px";this.layer.style.top=(this.getTop()+this.textbox.offsetHeight)+"px";this.layer.style.visibility="visible"};AutoSuggestControl.prototype.typeAhead=function(b){if(this.textbox.createTextRange||this.textbox.setSelectionRange){var a=this.textbox.value.length;this.textbox.value=b;this.selectRange(a,b.length)}};