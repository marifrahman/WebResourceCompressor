function getPageScroll(){var a;if(self.pageYOffset){a=self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){a=document.documentElement.scrollTop}else{if(document.body){a=document.body.scrollTop}}}arrayPageScroll=new Array("",a);return arrayPageScroll}function getPageSize(){var d,e;if(window.innerHeight&&window.scrollMaxY){d=document.body.scrollWidth;e=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){d=document.body.scrollWidth;e=document.body.scrollHeight}else{d=document.body.offsetWidth;e=document.body.offsetHeight}}var b,a;if(self.innerHeight){b=self.innerWidth;a=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body){b=document.body.clientWidth;a=document.body.clientHeight}}}if(e<a){pageHeight=a}else{pageHeight=e}if(d<b){pageWidth=b}else{pageWidth=d}arrayPageSize=new Array(pageWidth,pageHeight,b,a);return arrayPageSize}function createOverlay(n,r,q){var p="0.8";var k=document;var g=document.body;var h=g.appendChild(k.createElement("div"));h.id="overlay1";h.className="overlay1";arrsizes=getPageSize();h.style.cssText="width: "+arrsizes[0]+"px; height: "+arrsizes[1]+"px;position: absolute;display: block;margin: 0px;z-index: 900;background-color: #000;filter:progid:DXImageTransform.Microsoft.Alpha(opacity="+parseInt(p*100)+");filter: alpha(opacity="+parseInt(p*100)+");opacity: "+p+";left: 0px;top: 0px;";var j=g.appendChild(k.createElement("div"));j.id="overlay2";j.className="overlay2";var t=parseInt((arrsizes[2]/2)-(r/2));var s=parseInt((arrsizes[3]/2)-(n/2));j.style.cssText="width: "+r+"px; height: "+n+"px; top: "+s+"px; left: "+t+"px;background-color: #FFF;padding-top: 10px;padding-left: 10px;padding-right: 10px;padding-bottom: 10px;position: absolute;z-index: 1000;display: block;overflow: hidden;";j.appendChild(k.createElement("br"));var l=j.appendChild(k.createElement("div"));l.style.cssText="width:19px;height:15px;position:absolute;right:0px;top:0px;";var o=l.appendChild(k.createElement("img"));o.src="images/closebutton.jpg";o.onclick=closeOverlay;o.style.cssText="cursor:pointer;";var m=j.appendChild(k.createElement("form"));m.id="overlayForm";var l=m.appendChild(k.createElement("div"));l.id="overlayContent";geturl(q,"1=1")}function closeOverlay(){document.body.removeChild(document.getElementById("overlay2"));document.body.removeChild(document.getElementById("overlay1"))}var overlayxmlHttp;function overlayGetXmlHttpObject(b){var d=null;if(navigator.userAgent.indexOf("MSIE")>=0){var f="Msxml2.XMLHTTP";if(navigator.appVersion.indexOf("MSIE 5.5")>=0){f="Microsoft.XMLHTTP"}try{d=new ActiveXObject(f);d.onreadystatechange=b;return d}catch(a){alert("Error. Scripting for ActiveX might be disabled");return}}if(navigator.userAgent.indexOf("Mozilla")>=0){d=new XMLHttpRequest();d.onload=b;d.onerror=b;return d}}function geturl(b,a){if(b.indexOf("?")>0){var b=b+"&pseudoParam="+new Date().getTime()}else{var b=b+"?pseudoParam="+new Date().getTime()}overlayxmlHttp=overlayGetXmlHttpObject(overlayCallBack2);if(a==""){a=getquerystring("overlayForm");document.getElementById("overlayContent").innerHTML="Sending..."}else{document.getElementById("overlayContent").innerHTML="Loading..."}overlayxmlHttp.open("POST",b,true);overlayxmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");overlayxmlHttp.setRequestHeader("Content-length",a.length);overlayxmlHttp.setRequestHeader("Connection","close");overlayxmlHttp.send(a)}function overlayCallBack2(){if(overlayxmlHttp.readyState==4||overlayxmlHttp.readyState=="complete"){var a=overlayxmlHttp.responseText;if(a.substring(0,2)!="ERR"){sethtml("overlayContent",a)}else{alert(a.replace("ERR",""))}}}function getquerystring(g){var f=document.forms[g];var n="";function h(j,o){n+=(n.length>0?"&":"")+escape(j).replace(/\+/g,"%2B")+"="+escape(o?o:"").replace(/\+/g,"%2B")}var a=f.elements;for(var k=0;k<a.length;k++){var b=a[k];var e=b.type.toUpperCase();var d=b.name;if(d){if(e=="TEXT"||e=="TEXTAREA"||e=="PASSWORD"||e=="BUTTON"||e=="RESET"||e=="SUBMIT"||e=="FILE"||e=="IMAGE"||e=="HIDDEN"){h(d,b.value)}else{if(e=="CHECKBOX"&&b.checked){h(d,b.value?b.value:"On")}else{if(e=="RADIO"&&b.checked){h(d,b.value)}else{if(e.indexOf("SELECT")!=-1){for(var l=0;l<b.options.length;l++){var m=b.options[l];if(m.selected){h(d,m.value?m.value:m.text)}}}}}}}}return n}function sethtml(div,content){var search=content;var script;var is_singleq=0;var singleq="'";var is_doubleq=0;var doubleq='"';var is_escaped=0;var escap="\\";var layer=0;while(script=search.match(/(<script[^>]+javascript[^>]+>\s*(<!--)?)/)){search=search.substr(search.indexOf(RegExp.$1)+RegExp.$1.length);if(!(endscript=search.match(/((-->)?\s*<\/script>)/))){break}block=search.substr(0,search.indexOf(RegExp.$1));search=search.substring(block.length+RegExp.$1.length);while(func=block.match(/(function (.+?)\((.*?)\)\s*\{)/)){eval(block.substr(0,block.indexOf(RegExp.$1)));block=block.substr(block.indexOf(RegExp.$1)+RegExp.$1.length);name=RegExp.$2;param=RegExp.$3;is_singleq=0;is_doubleq=0;is_escaped=0;layer=0;for(i=0;i<block.length;i++){c=block.substr(i,1);if((is_singleq||is_doubleq)&&is_escaped){is_escaped=0}else{if(!is_doubleq&&(c==singleq)){is_singleq=!is_singleq}else{if(!is_singleq&&(c==doubleq)){is_doubleq=!is_doubleq}else{if((is_singleq||is_doubleq)&&(c==escap)){is_escaped=1}else{if(c=="{"){layer++}else{if(c=="}"){if(layer==0){break}layer--}}}}}}}code=block.substr(0,i-1);block=block.substr(i+1);code=code.replace(/\n/g,"\\n");code=code.replace(/\r/g,"\\r");code=code.replace(/'/g,"\\'");try{eval(name+" = new Function('"+param+"','"+code+"');")}catch(err){}}eval(block)}document.getElementById(div).innerHTML=content}function checkFields(a,d){nosubmit=false;for(var b=0;b<a.length;b++){if(document.getElementById(a[b]).value==""){nosubmit=true;document.getElementById(a[b]).setAttribute("style","background-color: red;")}else{document.getElementById(a[b]).setAttribute("style","background-color: white;")}}if(nosubmit==true){alert("You did not fill out the whole form")}else{geturl(d,"")}};