var canvascheck=document.createElement("canvas");var isIE=window.navigator.systemLanguage?1:0;var isI8=isIE&&document.documentMode?1:0;var isVM=document.namespaces?1:0;var isCV=canvascheck.getContext?1:0;var isJG=0,jg=new Array();function showCoords(c,a,e,f,d,b){}function getClassValue(a,d){var e=0;var c=d.length;for(var b=0;b<a.length;b++){if(a[b].indexOf(d)==0){e=Math.min(a[b].substring(c),100);break}}return Math.max(0,e)}function getClassRGBColor(c,i,d){var k,l=d,h=i.length;for(var g=0;g<c.length;g++){if(c[g].indexOf(i)==0){k=c[g].substring(h);l=k.toLowerCase();break}}if(!l.match(/^[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i)){l=d||"000000"}if(!isCV){return l}else{function f(j){return(Math.max(0,Math.min(parseInt(j,16),255)))}var e=f(l.substr(0,2)),b=f(l.substr(2,2)),a=f(l.substr(4,2));return e+","+b+","+a}}function performRGBColor(f,c){if(!f.match(/^#[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i)){f=c||"#000000"}if(!isCV){return f.substr(1,6)}else{function e(g){return(Math.max(0,Math.min(parseInt(g,16),255)))}var d=e(f.substr(1,2)),b=e(f.substr(3,2)),a=e(f.substr(5,2));return d+","+b+","+a}}function getClassAttribute(a,d){var e=0;var c=d.length;for(var b=0;b<a.length;b++){if(a[b].indexOf(d)==0){e=1;break}}return e}function fadeCanvas(a,c){var b=document.getElementById(a);if(b.fading==1&&c<=100){b.style.opacity=c/100;c+=10;window.setTimeout("fadeCanvas('"+a+"',"+c+")",10)}}function setAreaOver(K,D,h,s,L,I,B,U){var e,C,E,A,m,J,g,H,G,N,R,Q,S,T,M,w,F=0,P="",N=K.getAttribute("rel"),q=document.getElementById(D);if(N!=null){A=N.split(",");R=A.unshift(K.id)}else{A=new Array(K.id)}function O(){if(G.indexOf("forcegroup")!=-1){F=getClassAttribute(Q,"forcegroup")}else{F=0}if(G.indexOf("iopacity")!=-1){J=getClassValue(Q,"iopacity")/100}else{J=L}if(G.indexOf("iborder")!=-1){g=getClassRGBColor(Q,"iborder",h)}else{g=h}if(G.indexOf("icolor")!=-1){m=getClassRGBColor(Q,"icolor",s)}else{m=s}if(G.indexOf("noborder")!=-1){H=getClassAttribute(Q,"noborder")}else{H=I}}if(isVM){for(e=0;e<A.length;e++){K=document.getElementById(A[e]);M="",G=K.className,Q=G.split(" "),R=K.coords.split(",");if(F==0){O()}if(K.shape.toLowerCase()=="rect"){P+='<v:rect unselectable="on" strokeweight="1" filled="t" stroked="'+(H<1?"t":"f")+'" strokecolor="#'+g+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(R[0])+"px;top:"+parseInt(R[1])+"px;width:"+parseInt(R[2]-R[0])+"px;height:"+parseInt(R[3]-R[1])+'px;"><v:fill color="#'+m+'" opacity="'+J+'" /></v:rect>'}else{if(K.shape.toLowerCase()=="circle"){P+='<v:oval unselectable="on" strokeweight="1" filled="t" stroked="'+(H<1?"t":"f")+'" strokecolor="#'+g+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(R[0]-R[2])+"px;top:"+parseInt(R[1]-R[2])+"px;width:"+(parseInt(R[2])*2)+"px;height:"+(parseInt(R[2])*2)+'px;"><v:fill color="#'+m+'" opacity="'+J+'" /></v:oval>'}else{for(E=2;E<R.length;E+=2){M+=parseInt(R[E])+","+parseInt(R[E+1])+","}P+='<v:shape unselectable="on" strokeweight="1" filled="t" stroked="'+(H<1?"t":"f")+'" strokecolor="#'+g+'" coordorigin="0,0" coordsize="'+q.width+","+q.height+'" path="m '+parseInt(R[0])+","+parseInt(R[1])+" l "+M+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+q.width+"px;height:"+q.height+'px;"><v:fill color="#'+m+'" opacity="'+J+'" /></v:shape>'}}}q.innerHTML=P}else{if(isCV){if(B<1){q.fading=0;q.style.opacity=0}w=q.getContext("2d");for(e=0;e<A.length;e++){K=document.getElementById(A[e]);G=K.className,Q=G.split(" "),R=K.coords.split(",");if(F==0){O()}w.beginPath();if(K.shape.toLowerCase()=="rect"){w.rect(0.5+parseInt(R[0]),0.5+parseInt(R[1]),parseInt(R[2]-R[0]),parseInt(R[3]-R[1]));w.closePath()}else{if(K.shape.toLowerCase()=="circle"){w.arc(0.5+parseInt(R[0]),0.5+parseInt(R[1]),parseInt(R[2]),0,(Math.PI/180)*360,false)}else{w.moveTo(parseInt(R[0]),parseInt(R[1]));for(E=2;E<R.length;E+=2){w.lineTo(parseInt(R[E]),parseInt(R[E+1]))}w.closePath()}}w.fillStyle="rgba("+m+","+J+")";w.strokeStyle="rgba("+g+",1)";w.fill();if(H<1){w.stroke()}}if(B<1){q.fading=1;fadeCanvas(D,0)}}else{J=L;G=K.className;Q=G.split(" ");if(G.indexOf("forcegroup")!=-1){F=getClassAttribute(Q,"forcegroup");if(F!=0){if(G.indexOf("iopacity")!=-1){J=getClassValue(Q,"iopacity")/100;F=0}}}if(isIE){q.style.filter="Alpha(opacity="+(J*100)+")"}else{q.style.opacity=J;q.style.MozOpacity=J;q.style.KhtmlOpacity=J}for(e=0;e<A.length;e++){K=document.getElementById(A[e]);G=K.className,Q=G.split(" "),R=K.coords.split(",");if(F==0){if(G.indexOf("forcegroup")!=-1){F=getClassAttribute(Q,"forcegroup")}else{F=0}if(G.indexOf("icolor")!=-1){m=getClassRGBColor(Q,"icolor",s)}else{m=s}}jg[U].setColor("#"+m);if(K.shape.toLowerCase()=="rect"){jg[U].fillRect(parseInt(R[0]),parseInt(R[1]),parseInt(R[2]-R[0])+1,parseInt(R[3]-R[1])+1)}else{if(K.shape.toLowerCase()=="circle"){jg[U].fillEllipse(parseInt(R[0]-R[2]),parseInt(R[1]-R[2]),parseInt(R[2])*2+1,parseInt(R[2])*2+1)}else{S=new Array();T=new Array();C=0;for(E=0;E<R.length;E+=2){S[C]=parseInt(R[E]);T[C]=parseInt(R[E+1]);C++}jg[U].fillPolygon(S,T)}}jg[U].paint()}}}}function setAreaOut(e,d,c,g){var a=document.getElementById(d);if(isVM){a.innerHTML=""}else{if(isJG){jg[g].clear()}else{if(isCV){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height)}}}}function extAreaOver(e,b){var f=document.getElementById(e);var g=document.getElementById(b);var d=document.getElementById(f.canvasid);var c=performRGBColor(f.options.bordercolor,"#0000ff");var a=performRGBColor(f.options.areacolor,"#000000");var h=f.options.opacity/100;if(f&&g&&d){setAreaOver(g,f.canvasid,c,a,h,f.options.noborder,f.options.nofade,f.jg)}}function extAreaOut(c,a){var d=document.getElementById(c);var e=document.getElementById(a);var b=document.getElementById(d.canvasid);if(d&&e&&b){setAreaOut(e,d.canvasid,d.options.nofade,d.jg)}}function getCoords(f,m,b,l,C,D,B,k,u,s){var A,p,q,r,g,j,c,d,v=0,z=0;if(!f){f=window.event}if(f.pageX||f.pageY){v=f.pageX;z=f.pageY}g=f.clientX;j=f.clientY;if(self.pageXOffset||self.pageYOffset){q=self.pageXOffset;if(q>0&&v==g){g-=q}r=self.pageYOffset;if(r>0&&z==j){j-=r}}else{if(document.documentElement){q=document.documentElement.scrollLeft;r=document.documentElement.scrollTop}else{if(document.body){q=document.body.scrollLeft;r=document.body.scrollTop}}}if(document.body.scrollHeight!=s||document.body.scrollWidth!=u){var p=document.getElementById(l);var A=findPosXY(p);C=A.x;D=A.y}c=Math.min(Math.max(g+q-C,0),B);d=Math.min(Math.max(j+r-D,0),k);showCoords(m,b,c,d,B,k)}function findPosXY(b){var c;var a={x:b.offsetLeft,y:b.offsetTop};if(b.offsetParent){c=findPosXY(b.offsetParent);a.x+=c.x;a.y+=c.y}return a}function roundedRect(a,f,g,e,b,d,c){if(!c){a.beginPath()}a.moveTo(f,g+d);a.lineTo(f,g+b-d);a.quadraticCurveTo(f,g+b,f+d,g+b);a.lineTo(f+e-d,g+b);a.quadraticCurveTo(f+e,g+b,f+e,g+b-d);a.lineTo(f+e,g+d);a.quadraticCurveTo(f+e,g,f+e-d,g);a.lineTo(f+d,g);a.quadraticCurveTo(f,g,f,g+d);if(!c){a.closePath()}}function getRadius(c,d,a){var b=(Math.min(d,a)/100);c=Math.max(Math.min(100,c/b),0);return c+"%"}var cvi_map={defaultRadius:0,defaultOpacity:33,defaultBordercolor:"#0000ff",defaultAreacolor:"#000000",defaultNoborder:false,defaultNofade:false,defaultShowcoords:false,defaultImgsrc:"",defaultMapid:"",defaultDelayed:false,add:function(h,o){var l,m=h.useMap.split("#");if(m[1]!=""&&m[1].length>=1){l=document.getElementsByName(m[1])[0]}if(h.tagName.toUpperCase()=="IMG"&&l){var d={radius:cvi_map.defaultRadius,opacity:cvi_map.defaultOpacity,bordercolor:cvi_map.defaultBordercolor,areacolor:cvi_map.defaultAreacolor,noborder:cvi_map.defaultNoborder,nofade:cvi_map.defaultNofade,showcoords:cvi_map.defaultShowcoords,imgsrc:cvi_map.defaultImgsrc,mapid:cvi_map.defaultMapid,delayed:cvi_map.defaultDelayed};if(o){for(var g in d){if(!o[g]){o[g]=d[g]}}}else{o=d}var k=("iwidth" in o)?parseInt(o.iwidth):h.width;var j=("iheight" in o)?parseInt(o.iheight):h.height;try{var n=h.parentNode;n.style.position=(n.style.position=="static"||n.style.position==""?"relative":n.style.position);n.style.height=h.height+"px";n.style.width=h.width+"px";n.style.padding=0+"px";n.style.MozUserSelect="none";n.style.KhtmlUserSelect="none";n.unselectable="on";var b,a,c;h.jg=0;if(isVM){if(document.namespaces.v==null){var f=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","roundrect","oval","rect","arc","image"],p=document.createStyleSheet();for(var g=0;g<f.length;g++){p.addRule("v\\:"+f[g],"behavior: url(#default#VML);")}document.namespaces.add("v","urn:schemas-microsoft-com:vml")}c=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+h.width+"px;height:"+h.height+'px;padding:0;">'].join(""));a=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+h.width+"px;height:"+h.height+'px;padding:0;">'].join(""));dummy=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+h.width+"px;height:"+h.height+'px;padding:0;">'].join(""))}else{if(isCV){c=document.createElement("canvas");a=document.createElement("canvas")}else{c=document.createElement("div");a=document.createElement("img");a.src=h.src;if(typeof(window.jsGraphics)!=="undefined"){h.jg=parseInt(jg.length);jg[h.jg]=new jsGraphics(c);isJG=1}}}c.id=h.id+"_canvas";c.style.height=h.height+"px";c.style.width=h.width+"px";c.height=h.height;c.width=h.width;c.left=0;c.top=0;c.style.position="absolute";c.style.left=0+"px";c.style.top=0+"px";c.fading=0;h.className="";h.style.cssText="";h.left=0;h.top=0;h.style.position="absolute";h.style.height=h.height+"px";h.style.width=h.width+"px";h.style.left=0+"px";h.style.top=0+"px";h.style.MozUserSelect="none";h.style.KhtmlUserSelect="none";h.unselectable="on";h.options=o;h.canvasid=h.id+"_canvas";h.dummyid=h.id+"_dummy";h.bgrndid=h.id+"_image";h.blindid=l.name+"_blind";h.mapname=l.name;h.areas=l.innerHTML;h.active=false;if(isIE){h.style.filter="Alpha(opacity=0)"}else{h.style.opacity=0;h.style.MozOpacity=0;h.style.KhtmlOpacity=0}a.id=h.bgrndid;a.left=0;a.top=0;a.style.position="absolute";a.style.height=h.height+"px";a.style.width=h.width+"px";a.style.left=0+"px";a.style.top=0+"px";a.height=h.height;a.width=h.width;b=document.createElement("div");b.id=h.blindid;b.className="blind_area";b.left=0;b.top=0;b.style.position="absolute";b.style.height=h.height+"px";b.style.width=h.width+"px";b.style.left=0+"px";b.style.top=0+"px";b.innerHTML=" ";n.insertBefore(c,h);n.insertBefore(a,c);n.insertBefore(b,h);cvi_map.modify(h,o)}catch(f){}}},modify:function(l,v){try{var x=(typeof v.radius=="number"?v.radius:l.options.radius);l.options.radius=x;var u=(typeof v.opacity=="number"?v.opacity:l.options.opacity);l.options.opacity=u;var b=(typeof v.bordercolor=="string"?v.bordercolor:l.options.bordercolor);l.options.bordercolor=b;var a=(typeof v.areacolor=="string"?v.areacolor:l.options.areacolor);l.options.areacolor=a;var r=(typeof v.noborder=="boolean"?v.noborder:l.options.noborder);l.options.noborder=r;var s=(typeof v.nofade=="boolean"?v.nofade:l.options.nofade);l.options.nofade=s;var z=(typeof v.showcoords=="boolean"?v.showcoords:l.options.showcoords);l.options.showcoords=z;var g=(typeof v.delayed=="boolean"?v.delayed:l.options.delayed);l.options.delayed=g;var n=(typeof v.imgsrc=="string"?v.imgsrc:l.options.imgsrc);l.options.imgsrc=n;var q=(typeof v.mapid=="string"?v.mapid:l.options.mapid);l.options.mapid=q;var f,j,k=l.height,o=l.width;var x=parseInt(Math.min(Math.min(o/4,k/4),x));var u=u==0?0.33:u/100;var b=performRGBColor(b,"#0000ff");var a=performRGBColor(a,"#000000");var d=document.getElementById(l.canvasid);var h=document.getElementById(l.dummyid);var c=document.getElementById(l.bgrndid);var p=document.getElementsByName(l.mapname)[0];var t=100;function y(){if(q!=""){var e=document.getElementById(q);if(e){p.innerHTML=e.innerHTML}}else{p.innerHTML=l.areas}}function w(){if(!g){y()}for(var A=0;A<p.areas.length;A++){if(p.areas[A].shape.match(/(rect|poly|circle)/i)){if(window.opera||p.areas[A].coords!=""){if(p.areas[A].id==""){p.areas[A].id=l.mapname+"_"+A}if(isVM||isIE){j=p.areas[A].onmouseover;if(j!=null){tmp=String(j);j=(tmp.indexOf("anonymous()")>=0?tmp.substr(23,tmp.length-25):tmp)}p.areas[A].onmouseover=new Function('setAreaOver(this,"'+d.id+'","'+b+'","'+a+'",'+u+","+r+","+s+","+l.jg+");"+j);j=p.areas[A].onmouseout;if(j!=null){tmp=String(j);j=(tmp.indexOf("anonymous()")>=0?tmp.substr(23,tmp.length-25):tmp)}p.areas[A].onmouseout=new Function('setAreaOut(this,"'+d.id+'",'+s+","+l.jg+");"+j)}else{j=p.areas[A].getAttribute("onmouseover");p.areas[A].setAttribute("onmouseover","setAreaOver(this,'"+d.id+"','"+b+"','"+a+"',"+u+","+r+","+s+","+l.jg+");"+j);j=p.areas[A].getAttribute("onmouseout");p.areas[A].setAttribute("onmouseout","setAreaOut(this,'"+d.id+"',"+s+","+l.jg+");"+j)}}}}if(z){var e,D=findPosXY(l),B=document.body.scrollHeight,C=document.body.scrollWidth;if(isVM||isIE){l.onmousemove=new Function('getCoords(event,"'+l.mapname+'",0,"'+l.id+'",'+D.x+","+D.y+","+o+","+k+","+C+","+B+");"+l.movefunc)}else{l.setAttribute("onmousemove","getCoords(event,'"+l.mapname+"',0,'"+l.id+"',"+D.x+","+D.y+","+o+","+k+","+C+","+B+");"+l.movefunc)}if(p.length>0){for(var A=0;A<p.areas.length;A++){if(p.areas[A].shape.match(/(rect|poly|circle)/i)){if(window.opera||p.areas[A].coords!=""){e=p.areas[A].id;if(isVM||isIE){j=p.areas[A].onmousemove;if(j!=null){tmp=String(j);j=tmp.substr(23,tmp.length-25)}p.areas[A].onmousemove=new Function('getCoords(event,"'+l.mapname+'","'+e+'","'+l.id+'",'+D.x+","+D.y+","+o+","+k+","+C+","+B+");"+j)}else{j=p.areas[A].getAttribute("onmousemove");p.areas[A].setAttribute("onmousemove","getCoords(event,'"+l.mapname+"','"+e+"','"+l.id+"',"+D.x+","+D.y+","+o+","+k+","+C+","+B+");"+j)}}}}}}}if(d&&c&&p){if(isCV){f=d.getContext("2d");f.clearRect(0,0,d.width,d.height)}else{if(isVM){d.innerHTML=""}else{if(isIE){d.style.filter="Alpha(opacity="+(u*100)+")"}else{d.style.opacity=u;d.style.MozOpacity=u;d.style.KhtmlOpacity=u}if(isJG){jg[l.jg].clear()}}}if(g){y()}if(isCV){if(n!=""){var m=new Image();m.onload=function(){f=c.getContext("2d");f.clearRect(0,0,c.width,c.height);f.save();if(x>0){roundedRect(f,0,0,c.width,c.height,x);f.clip()}f.fillStyle="rgba(0,0,0,0)";f.fillRect(0,0,c.width,c.height);f.drawImage(m,0,0,c.width,c.height);f.restore();w()};m.src=n}else{f=c.getContext("2d");f.clearRect(0,0,c.width,c.height);f.save();if(x>0){roundedRect(f,0,0,c.width,c.height,x);f.clip()}f.fillStyle="rgba(0,0,0,0)";f.fillRect(0,0,c.width,c.height);f.drawImage(l,0,0,c.width,c.height);f.restore();w()}}else{if(isVM){if(x>0){x=getRadius(x,c.width,c.height)}c.innerHTML='<v:roundrect arcsize="'+x+'" strokeweight="0" filled="t" stroked="f" fillcolor="#ffffff" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:0px;top:0px;width:'+c.width+"px;height:"+c.height+'px;"><v:fill src="'+(n!=""?n:l.src)+'" type="frame" /></v:roundrect>';w()}else{c.src=n!=""?n:l.src;w()}}l.active=true;if(isVM||isIE){j=l.onmousemove;if(j!=null){tmp=String(j);j=tmp.substr(23,tmp.length-25)}l.movefunc=j}else{l.movefunc=l.getAttribute("onmousemove")}}}catch(i){}},remove:function(b){var a,c=b.parentNode;if(b.active){if(isIE){b.style.filter="Alpha(opacity=100)"}else{b.style.opacity=100;b.style.MozOpacity=100;b.style.KhtmlOpacity=100}a=document.getElementsByName(b.mapname)[0];a.innerHTML=b.areas;b.active=false;b.areas="";if(isVM||isIE){b.onmousemove=b.movefunc}else{b.setAttribute("onmousemove",b.movefunc)}a=document.getElementById(b.canvasid);if(a){c.removeChild(a)}a=document.getElementById(b.blindid);if(a){c.removeChild(a)}a=document.getElementById(b.bgrndid);if(a){c.removeChild(a)}}}};