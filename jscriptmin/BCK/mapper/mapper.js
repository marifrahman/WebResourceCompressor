var canvascheck=document.createElement("canvas");var isIE=window.navigator.systemLanguage?1:0;var isVM=document.namespaces?1:0;var isJG=0;var isCV=canvascheck.getContext?1:0;var jg=new Array();if(isVM){if(document.namespaces.v==null){var e=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","roundrect","oval","rect","arc","image"],s=document.createStyleSheet();for(var i=0;i<e.length;i++){s.addRule("v\\:"+e[i],"behavior: url(#default#VML); antialias: true;")}document.namespaces.add("v","urn:schemas-microsoft-com:vml")}}function showCoords(c,a,f,g,d,b){}function getClasses(a,c){var d="";for(var b=0;b<a.length;b++){if(a[b]!=c){if(d){d+=" "}d+=a[b]}}return d}function getClassValue(a,d){var f=0;var c=d.length;for(var b=0;b<a.length;b++){if(a[b].indexOf(d)==0){f=Math.min(a[b].substring(c),100);break}}return Math.max(0,f)}function getClassRGBColor(c,l,d){var m,n=d,k=l.length;for(var h=0;h<c.length;h++){if(c[h].indexOf(l)==0){m=c[h].substring(k);n=m.toLowerCase();break}}if(!n.match(/^[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i)){n=d||"000000"}if(!isCV){return n}else{function g(j){return(Math.max(0,Math.min(parseInt(j,16),255)))}var f=g(n.substr(0,2)),b=g(n.substr(2,2)),a=g(n.substr(4,2));return f+","+b+","+a}}function getClassAttribute(a,d){var f=0;var c=d.length;for(var b=0;b<a.length;b++){if(a[b].indexOf(d)==0){f=1;break}}return f}function getMaps(c){var b=document.getElementsByTagName("img");var f=new Array();var g=0;var l="";var a;var d;var h=0;var k="";for(g=0;g<b.length;g++){a=b[g];d=a.className.split(" ");for(h=0;h<d.length;h++){if(d[h]==c){l=a.useMap.split("#");if(l[1]!=""&&l[1].length>=1){k=document.getElementsByName(l[1]);if(k){f.push(a);break}}}}}return f}function fadeCanvas(a,c){var b=document.getElementById(a);if(b.fading==1&&c<=100){b.style.opacity=c/100;c+=10;window.setTimeout("fadeCanvas('"+a+"',"+c+")",10)}}function setAreaOver(M,F,m,A,N,K,D,W){var g,E,G,C,q,L,h,J,I,P,T,S,U,V,O,H=0,R="",P=M.getAttribute("rel"),B,w=document.getElementById(F);if(P!=null){C=P.split(",");T=C.unshift(M.id)}else{C=new Array(M.id)}function Q(){if(I.indexOf("forcegroup")!=-1){H=getClassAttribute(S,"forcegroup")}else{H=0}if(I.indexOf("iopacity")!=-1){L=getClassValue(S,"iopacity")/100}else{L=N}if(I.indexOf("iborder")!=-1){h=getClassRGBColor(S,"iborder",m)}else{h=m}if(I.indexOf("icolor")!=-1){q=getClassRGBColor(S,"icolor",A)}else{q=A}if(I.indexOf("noborder")!=-1){J=getClassAttribute(S,"noborder")}else{J=K}}if(isVM){for(g=0;g<C.length;g++){M=document.getElementById(C[g]);if(M){O="",I=M.className,S=I.split(" "),T=M.coords.split(",");if(H==0){Q()}if(M.shape.toLowerCase()=="rect"){R+='<v:rect strokeweight="1" filled="t" stroked="'+(J<1?"t":"f")+'" strokecolor="#'+h+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(T[0])+"px;top:"+parseInt(T[1])+"px;width:"+parseInt(T[2]-T[0])+"px;height:"+parseInt(T[3]-T[1])+'px;"><v:fill color="#'+q+'" opacity="'+L+'" /></v:rect>'}else{if(M.shape.toLowerCase()=="circle"){R+='<v:oval strokeweight="1" filled="t" stroked="'+(J<1?"t":"f")+'" strokecolor="#'+h+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(T[0]-T[2])+"px;top:"+parseInt(T[1]-T[2])+"px;width:"+(parseInt(T[2])*2)+"px;height:"+(parseInt(T[2])*2)+'px;"><v:fill color="#'+q+'" opacity="'+L+'" /></v:oval>'}else{for(G=2;G<T.length;G+=2){O+=parseInt(T[G])+","+parseInt(T[G+1])+","}R+='<v:shape strokeweight="1" filled="t" stroked="'+(J<1?"t":"f")+'" strokecolor="#'+h+'" coordorigin="0,0" coordsize="'+w.width+","+w.height+'" path="m '+parseInt(T[0])+","+parseInt(T[1])+" l "+O+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+w.width+"px;height:"+w.height+'px;"><v:fill color="#'+q+'" opacity="'+L+'" /></v:shape>'}}}}w.innerHTML=R}else{if(isCV){if(D<1){w.fading=0;w.style.opacity=0}B=w.getContext("2d");for(g=0;g<C.length;g++){M=document.getElementById(C[g]);if(M){I=M.className,S=I.split(" "),T=M.coords.split(",");if(H==0){Q()}B.beginPath();if(M.shape.toLowerCase()=="rect"){B.rect(0.5+parseInt(T[0]),0.5+parseInt(T[1]),parseInt(T[2]-T[0]),parseInt(T[3]-T[1]));B.closePath()}else{if(M.shape.toLowerCase()=="circle"){B.arc(0.5+parseInt(T[0]),0.5+parseInt(T[1]),parseInt(T[2]),0,(Math.PI/180)*360,false)}else{B.moveTo(parseInt(T[0]),parseInt(T[1]));for(G=2;G<T.length;G+=2){B.lineTo(parseInt(T[G]),parseInt(T[G+1]))}B.closePath()}}B.fillStyle="rgba("+q+","+L+")";B.strokeStyle="rgba("+h+",1)";B.fill();if(J<1){B.stroke()}}}if(D<1){w.fading=1;fadeCanvas(F,0)}}else{L=N;I=M.className;S=I.split(" ");if(I.indexOf("forcegroup")!=-1){H=getClassAttribute(S,"forcegroup");if(H!=0){if(I.indexOf("iopacity")!=-1){L=getClassValue(S,"iopacity")/100;H=0}}}if(isIE){w.style.filter="Alpha(opacity="+(L*100)+")"}else{w.style.opacity=L;w.style.MozOpacity=L;w.style.KhtmlOpacity=L}for(g=0;g<C.length;g++){M=document.getElementById(C[g]);if(M){I=M.className,S=I.split(" "),T=M.coords.split(",");if(H==0){if(I.indexOf("forcegroup")!=-1){H=getClassAttribute(S,"forcegroup")}else{H=0}if(I.indexOf("icolor")!=-1){q=getClassRGBColor(S,"icolor",A)}else{q=A}}jg[W].setColor("#"+q);if(M.shape.toLowerCase()=="rect"){jg[W].fillRect(parseInt(T[0]),parseInt(T[1]),parseInt(T[2]-T[0])+1,parseInt(T[3]-T[1])+1)}else{if(M.shape.toLowerCase()=="circle"){jg[W].fillEllipse(parseInt(T[0]-T[2]),parseInt(T[1]-T[2]),parseInt(T[2])*2+1,parseInt(T[2])*2+1)}else{U=new Array();V=new Array();E=0;for(G=0;G<T.length;G+=2){U[E]=parseInt(T[G]);V[E]=parseInt(T[G+1]);E++}jg[W].fillPolygon(U,V)}}jg[W].paint()}}}}}function setAreaOut(g,d,c,h){var a=document.getElementById(d);if(isVM){a.innerHTML=""}else{if(isJG){jg[h].clear()}else{if(isCV){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height)}}}}function getCoords(f,m,b,l,D,E,C,k,v,u){var B,p,q,r,g,j,c,d,z=0,A=0;if(!f){f=window.event}if(f.pageX||f.pageY){z=f.pageX;A=f.pageY}g=f.clientX;j=f.clientY;if(self.pageXOffset||self.pageYOffset){q=self.pageXOffset;if(q>0&&z==g){g-=q}r=self.pageYOffset;if(r>0&&A==j){j-=r}}else{if(document.documentElement){q=document.documentElement.scrollLeft;r=document.documentElement.scrollTop}else{if(document.body){q=document.body.scrollLeft;r=document.body.scrollTop}}}if(document.body.scrollHeight!=u||document.body.scrollWidth!=v){var p=document.getElementById(l);var B=findPosXY(p);D=B.x;E=B.y}c=Math.min(Math.max(g+q-D,0),C);d=Math.min(Math.max(j+r-E,0),k);showCoords(m,b,c,d,C,k)}function findPosXY(b){var c;var a={x:b.offsetLeft,y:b.offsetTop};if(b.offsetParent){c=findPosXY(b.offsetParent);a.x+=c.x;a.y+=c.y}return a}function roundedRect(a,g,h,f,b,d,c){if(!c){a.beginPath()}a.moveTo(g,h+d);a.lineTo(g,h+b-d);a.quadraticCurveTo(g,h+b,g+d,h+b);a.lineTo(g+f-d,h+b);a.quadraticCurveTo(g+f,h+b,g+f,h+b-d);a.lineTo(g+f,h+d);a.quadraticCurveTo(g+f,h,g+f-d,h);a.lineTo(g+d,h);a.quadraticCurveTo(g,h,g,h+d);if(!c){a.closePath()}}function getRadius(c,d,a){var b=(Math.min(d,a)/100);c=Math.max(Math.min(100,c/b),0);return c+"%"}function addMapper(){var Q=getMaps("mapper");var E,L,k,p,l,u,G,H,z,a;var q="",J="",B="",R,D,F,K,g,m,v,O,P,I,A,T,U,S,C,N,M;for(D=0;D<Q.length;D++){E=Q[D];L=E.parentNode;if(E.id==""){E.id="gmipam_"+D}L.style.position=(L.style.position=="static"||L.style.position==""?"relative":L.style.position);L.style.height=E.height+"px";L.style.width=E.width+"px";L.style.padding=0+"px";L.style.MozUserSelect="none";L.style.KhtmlUserSelect="none";L.unselectable="on";O=0;I=0;A=0;g="0000ff";m="000000";K=33;if(isCV){p=document.createElement("canvas")}else{if(isVM){p=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+E.width+"px;height:"+E.height+'px;padding:0;">'].join(""))}else{p=document.createElement("div")}}p.id=E.id+"_canvas";q=E.className.split(" ");O=getClassValue(q,"iradius");K=getClassValue(q,"iopacity");g=getClassRGBColor(q,"iborder","0000ff");m=getClassRGBColor(q,"icolor","000000");I=getClassAttribute(q,"noborder");A=getClassAttribute(q,"nofade");v=getClassAttribute(q,"showcoords");K=K==0?0.33:K/100;O=parseInt(Math.min(Math.min(E.width/4,E.height/4),O));J=getClasses(q,"mapper");E.className=J;H=E.useMap.split("#");H=H[1];G=document.getElementsByName(H);if(G.length>0){for(F=0;F<G[0].areas.length;F++){if(G[0].areas[F].shape.match(/(rect|poly|circle)/i)){if(window.opera||G[0].areas[F].coords!=""){if(G[0].areas[F].id==""){G[0].areas[F].id=H+"_"+F}if(isVM||isIE){B=G[0].areas[F].onmouseover;if(B!=null){R=String(B);B=R.substr(23,R.length-25)}G[0].areas[F].onmouseover=new Function('setAreaOver(this,"'+p.id+'","'+g+'","'+m+'","'+K+'",'+I+","+A+","+D+");"+B);B=G[0].areas[F].onmouseout;if(B!=null){R=String(B);B=R.substr(23,R.length-25)}G[0].areas[F].onmouseout=new Function('setAreaOut(this,"'+p.id+'",'+A+","+D+");"+B)}else{B=G[0].areas[F].getAttribute("onmouseover");G[0].areas[F].setAttribute("onmouseover","setAreaOver(this,'"+p.id+"','"+g+"','"+m+"','"+K+"',"+I+","+A+","+D+");"+B);B=G[0].areas[F].getAttribute("onmouseout");G[0].areas[F].setAttribute("onmouseout","setAreaOut(this,'"+p.id+"',"+A+","+D+");"+B)}}}}}p.style.height=E.height+"px";p.style.width=E.width+"px";p.height=E.height;p.width=E.width;p.left=0;p.top=0;p.style.position="absolute";p.style.left=0+"px";p.style.top=0+"px";p.fading=0;E.className="";E.style.cssText="";E.left=0;E.top=0;E.style.position="absolute";E.style.height=E.height+"px";E.style.width=E.width+"px";E.style.left=0+"px";E.style.top=0+"px";E.style.MozUserSelect="none";E.style.KhtmlUserSelect="none";E.unselectable="on";if(isIE){E.style.filter="Alpha(opacity=0)"}else{E.style.opacity=0;E.style.MozOpacity=0;E.style.KhtmlOpacity=0}if(isCV&&O>0){k=document.createElement("canvas")}else{if(isVM&&O>0){k=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+E.width+"px;height:"+E.height+'px;padding:0;">'].join(""))}else{k=document.createElement("img");k.src=E.src}}k.id=E.id+"_image";k.left=0;k.top=0;k.style.position="absolute";k.style.height=E.height+"px";k.style.width=E.width+"px";k.style.left=0+"px";k.style.top=0+"px";L.insertBefore(p,E);l=document.createElement("div");l.id=H+"_blind";l.className="blind_area";l.left=0;l.top=0;l.style.position="absolute";l.style.height=E.height+"px";l.style.width=E.width+"px";l.style.left=0+"px";l.style.top=0+"px";l.innerHTML=" ";L.insertBefore(l,E);if(isCV){u=p.getContext("2d");u.clearRect(0,0,p.width,p.height)}else{if(!isVM&&!isCV){if(isIE){p.style.filter="Alpha(opacity="+(K*100)+")"}else{p.style.opacity=K;p.style.MozOpacity=K;p.style.KhtmlOpacity=K}if(typeof(window.jsGraphics)!=="undefined"){jg[D]=new jsGraphics(p);isJG=1}}}L.insertBefore(k,p);if(isCV&&O>0){k.height=E.height;k.width=E.width;u=k.getContext("2d");u.clearRect(0,0,k.width,k.height);roundedRect(u,0,0,k.width,k.height,O);u.clip();u.fillStyle="rgba(0,0,0,0)";u.fillRect(0,0,k.width,k.height);u.drawImage(E,0,0,k.width,k.height)}else{if(isVM&&O>0){k.height=E.height;k.width=E.width;O=getRadius(O,k.width,k.height);k.innerHTML='<v:roundrect arcsize="'+O+'" strokeweight="0" filled="t" stroked="f" fillcolor="#ffffff" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:0px;top:0px;width:'+k.width+"px;height:"+k.height+'px;"><v:fill src="'+E.src+'" type="frame" /></v:roundrect>'}}if(v>0){z=document.getElementById(E.id);S=parseInt(E.width);C=parseInt(E.height);P=findPosXY(z);T=P.x;U=P.y;M=document.body.scrollHeight;N=document.body.scrollWidth;if(isVM||isIE){B=E.onmousemove;if(B!=null){R=String(B);B=R.substr(23,R.length-25)}E.onmousemove=new Function('getCoords(event,"'+H+'",0,"'+E.id+'",'+T+","+U+","+S+","+C+","+N+","+M+");"+B)}else{B=E.getAttribute("onmousemove");E.setAttribute("onmousemove","getCoords(event,'"+H+"',0,'"+E.id+"',"+T+","+U+","+S+","+C+","+N+","+M+");"+B)}if(G.length>0){for(F=0;F<G[0].areas.length;F++){if(G[0].areas[F].shape.match(/(rect|poly|circle)/i)){if(window.opera||G[0].areas[F].coords!=""){a=G[0].areas[F].id;if(isVM||isIE){B=G[0].areas[F].onmousemove;if(B!=null){R=String(B);B=R.substr(23,R.length-25)}G[0].areas[F].onmousemove=new Function('getCoords(event,"'+H+'","'+a+'","'+E.id+'",'+T+","+U+","+S+","+C+","+N+","+M+");"+B)}else{B=G[0].areas[F].getAttribute("onmousemove");G[0].areas[F].setAttribute("onmousemove","getCoords(event,'"+H+"','"+a+"','"+E.id+"',"+T+","+U+","+S+","+C+","+N+","+M+");"+B)}}}}}}}}var mapperOnload=window.onload;window.onload=function(){if(mapperOnload){mapperOnload()}addMapper()};