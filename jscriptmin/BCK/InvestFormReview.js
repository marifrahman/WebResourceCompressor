var errorDivs;function changeDisplay(a,b){if($(a)!=null){if(b=="show"){$(a).style.display=""}else{$(a).style.display=b}}}function checkNotify(a){var b=a.value;if(b=="other"){$("specifyDetail").style.display=""}else{$("specifyDetail").style.display="none"}}function checkDetails(a){var b=a.value;if(b=="Put Details"){a.value=""}}function addHOC(a,b){$(a+"layer").style.display="";$(a).value=b.value}function toggleHOC(a,b){$(a+"layer").style.display=b}function toggleExt(a){$("extDetails").style.display=a}function saveInvestigateDetails(){var a="incid="+document.frmInvestigate.incidentId.value;a+="&details="+$("txtInvestigateDetails").value;new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveDetails&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(b){moveSection("stepIncidentDetailsSub","stepInterviewSub")}})}function saveFiles(a){if($("riFileDesc").value==""){alert("File Description Required");$("riFileDesc").focus();return false}if(!checkFileExt($("riFilePath").value)){return false}fileUpload(document.frmInvestigate,"riSaveFile.asp?ua="+a+"&incid="+document.frmInvestigate.incidentId.value,"uploadedFile");$("riFileDesc").value="";$("dvRiFilePath").innerHTML='<input type="file" name="riFilePath" id="riFilePath" />'}function deleteFile(a,b){if(confirm("You are about to delete this file. Do you wish to continue?")){new Ajax.Request("Investformreview.asp?Ajax=1&doAction=delRIFiles&fileId="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(c){hideObject(b)}})}}function addInerviews(){var a="incid="+document.frmInvestigate.incidentId.value;a+="&pinterview="+$("interview").value;a+="&irecorded="+$RF("interviewRecorded");a+="&iDesc="+$("interviewDesc").value;new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveInterview&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(b){loadInterviews();$("interview").selectedIndex=0;$("jobTitle").value="";$("interviewDesc").value="";hideObject("tblInterview");showObject("trAddInterview")}})}function loadInterviews(){new Ajax.Request("Investformreview.asp?Ajax=1&loadIntv=1&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("interviewList").innerHTML=a.responseText;if(a.responseText==""){showObject("tblInterview");hideObject("trAddInterview")}}})}function deleteInterView(a){if(confirm("Do you want delete this Interview Record?")){new Ajax.Request("Investformreview.asp?Ajax=1&doAction=delInterview&iid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(b){loadInterviews()}})}}function uploadInterViewFile(a){if($("riFileDescInterview").value==""){alert("File Description Required");$("riFileDescInterview").focus();return false}if(!checkFileExt($("riFilePathInterview").value)){return false}fileUpload(document.frmInvestigate,"riSaveFileInterview.asp?ua="+a+"&incid="+document.frmInvestigate.incidentId.value,"uploadedInterviewFile");$("riFileDescInterview").value="";$("dvFilePathInterview").innerHTML='<input type="file" name="riFilePathInterview" id="riFilePathInterview"/>'}function loadMatrix(){new Ajax.Request("CreateRiskMatrix.asp?incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("riskMatrix").innerHTML=a.responseText}})}function saveLikelihood(b){var a="incid="+document.frmInvestigate.incidentId.value;a+="&llh="+b;new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveLikeLihood&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(c){loadMatrix();changeRiskLevel()}})}function saveSeverity(b){var a="incid="+document.frmInvestigate.incidentId.value;a+="&svr="+b;new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveSeverity&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(c){loadMatrix();changeRiskLevel()}})}function changeRiskLevel(){new Ajax.Request("Investformreview.asp?Ajax=1&doAction=getRiskLevel&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){if(a.responseText!=""){$("levelOfRisk").innerHTML="Risk Level: "+a.responseText}}})}function loadDistributorInfo(a){new Ajax.Request("ReportIncident.asp?Ajax=1&iid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(c){if(c.responseText!=""){var b=c.responseXML;$("distLocation").value=b.getElementsByTagName("location")[0].childNodes[0].nodeValue;$("distJobTitle").value=b.getElementsByTagName("jobTitle")[0].childNodes[0].nodeValue}}})}function loadIntervieweeInfo(a){new Ajax.Request("ReportIncident.asp?Ajax=1&iid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(c){if(c.responseText!=""){var b=c.responseXML;$("jobTitle").value=b.getElementsByTagName("jobTitle")[0].childNodes[0].nodeValue}}})}function loadDistributionList(){new Ajax.Request("Investformreview.asp?Ajax=1&loadDist=1&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("distributionList").innerHTML=a.responseText}})}function saveDistributionList(){var a="&incid="+document.frmInvestigate.incidentId.value;a+="&distid="+$("distId").value;a+="&distJobTitle="+escape($("distJobTitle").value);a+="&distRegion="+escape($("distLocation").value);new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveDist"+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(b){loadDistributionList();hideObject("tblDist");showObject("tblAddDist")}})}function updatePerson(b){var a=document.frmInvestigate.incidentId.value;var c="AddPerson.asp?inductid="+b+"&doAction=show&incid="+a;var d=window.open(c,"Update Person","height=500, width=600;")}function removeDistribution(b){if(confirm("This will remove the person from the incident. Do you want to continue?")){var a=document.frmInvestigate.incidentId.value;new Ajax.Request("Investformreview.asp?Ajax=1&doAction=removeDist&incid="+a+"&distid="+b+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(c){loadDistributionList()}})}}function saveExternalNotifier(){var b="&incid="+document.frmInvestigate.incidentId.value;b+="&reqEN="+$RF("externalNotifer");var a=document.getElementsByName("chkExternalNotifer");var c="";for(i=0;i<a.length;i++){if(a[i].checked){c+=a[i].value+";"}}b+="&valEN="+c;b+="&enOth="+escape($("specifyDetail").value);new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveEN&pseudoParam="+new Date().getTime(),{method:"POST",parameters:b,onSuccess:function(d){moveSection("stepExternalSub","stepSeveritySub")}})}function saveRootCause(){var c="incid="+document.frmInvestigate.incidentId.value;var b=$("rootCauseIds").value.split(";");var d="";var a="";for(i=0;i<b.length-1;i++){if($RF("rootMS_"+b[i])=="Yes"){c+="&causeDesc_"+b[i]+"="+escape($("causeDesc_"+b[i]).value);d+=b[i]+";"}else{if($RF("rootMS_"+b[i])=="No"){a+=b[i]+";"}}}c+="&rtIds="+d;c+="&delRTids="+a;new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveRC&pseudoParam="+new Date().getTime(),{method:"POST",parameters:c,onSuccess:function(e){loadCorrectiveActionsRows()}})}function loadCorrectiveActionsRows(a){var b=document.getElementById("heirarchySecNum").innerHTML;new Ajax.Request("Investformreview.asp?Ajax=1&loadCA=1&incid="+document.frmInvestigate.incidentId.value+"&secNum="+b+"&pseudoParam="+new Date().getTime(),{method:"GET",onSuccess:function(c){$("caList").innerHTML=c.responseText}})}function saveCorrectiveActions(a){if($("caWhen_"+a).value==""){alert("'By When' field must have a date value.");$("caWhen_"+a).focus();return false}if($("caTakenBy_"+a).selectedIndex==0){alert("'By Whom' field must be selected. ");$("caTakenBy_"+a).focus();return false}var b="incid="+document.frmInvestigate.incidentId.value;b+="&ircid="+a;b+="&details="+escape($("txtCaDetails_"+a).value);b+="&caTakenBy="+$("caTakenBy_"+a).value;b+="&caWhen="+$("caWhen_"+a).value;b+="&caStatus="+$("caStatus_"+a).value;new Ajax.Request("Investformreview.asp?Ajax=1&doAction=saveRCA&pseudoParam="+new Date().getTime(),{method:"POST",parameters:b,onSuccess:function(c){loadCorrectiveActions(a);$("txtCaDetails_"+a).value="";$("caTakenBy_"+a).selectedIndex=0;$("caWhen_"+a).value="";$("caStatus_"+a).selectedIndex=0}})}function loadCorrectiveActions(a){var b=document.getElementById("heirarchySecNum").innerHTML;new Ajax.Request("Investformreview.asp?Ajax=1&loadCAList=1&ircid="+a+"&secNum="+b+"&pseudoParam="+new Date().getTime(),{method:"GET",onSuccess:function(c){$("rcaList_"+a).innerHTML=c.responseText}})}function addNewDistributor(){var a=document.frmInvestigate.incidentId.value;var b=window.open("AddPerson.asp?addAs=INVDIST&incid="+a,"","height=500, width=600;",false)}function editCorrectiveAction(a,b){var c=window.open("editCA.asp?caid="+a+"&ircid="+b,"","height=500, width=600;",false)}function deleteCorrectiveAction(a,b){if(confirm("You are about to delete this corrective action. Do you wish to continue?")){new Ajax.Request("Investformreview.asp?Ajax=1&doAction=delCA&caid="+a+"&pseudoParam="+new Date().getTime(),{method:"GET",onSuccess:function(c){loadCorrectiveActions(b)}})}}function finish(){showProcess();clearErrorMsg();var a=document.frmInvestigate.incidentId.value;new Ajax.Request("Investformreview.asp?Ajax=1&checkForm=1&incid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(g){new Effect.Opacity("dvReview",{from:0.5,to:0});var h=g.responseXML;var b=h.getElementsByTagName("ERROR");var f=false;errorDivs=new Array();for(i=0;i<b.length;i++){var d=b[i];errorDivs.push(new Array(d.childNodes[1].childNodes[0].nodeValue,$(d.childNodes[2].childNodes[0].nodeValue).style.display));$(d.childNodes[1].childNodes[0].nodeValue).style.display="";$(d.childNodes[2].childNodes[0].nodeValue).style.display="";$(d.childNodes[2].childNodes[0].nodeValue).innerHTML+=d.childNodes[3].childNodes[0].nodeValue+"<br/>";f=true}$("dvReview").style.display="none";if(f){alert("Please fill in the following information marked red")}if(!f){if(confirm("You are about to finish this investigation. Click OK to confirm or cancel to make changes?")){try{if($("incidentId").value!=""){ir_delExpandedId($("incidentId").value+"_tabstate","stepDistributionListSub")}}catch(c){}document.frmInvestigate.action="InvestFinishEmail.asp";document.frmInvestigate.submit()}}},onFailure:function(b){alert("An error occured while trying to check the data. Please click on Review again. \n(If this message continues to appear contact Rapid Induct");$("dvReview").style.display="none"}})}function clearErrorMsg(){var a=document.getElementsByTagName("DIV");for(i=0;i<a.length;i++){var b=a[i].getAttribute("id");if(b!=null){if(b.indexOf("errorMsg")>-1){$(b).innerHTML="";$(b).style.display=""}}}if(errorDivs!=null){for(i=0;i<errorDivs.length;i++){var c=errorDivs[i];$(c[0]).style.display=c[1]}}}function setInnerHTML(c,b){try{$(c).innerHTML=b.value}catch(a){}}function saveAllCorrectiveAction(){var a=document.getElementsByName("incidentRootCauseId");var b="incid="+document.frmInvestigate.incidentId.value;b+="&ircCount="+a.length;var c=false;for(i=0;i<a.length;i++){if($("txtCaDetails_"+a[i].value).value!=""){if($("caWhen_"+a[i].value).value==""){alert("'By When' field must have a date value.");$("caWhen_"+a[i].value).focus();return false}if($("caTakenBy_"+a[i].value).selectedIndex==0){alert("'By Whom' field must be selected. ");$("caTakenBy_"+a[i].value).focus();return false}b+="&ircid_"+i+"="+a[i].value;b+="&details_"+i+"="+escape($("txtCaDetails_"+a[i].value).value);b+="&caTakenBy_"+i+"="+$("caTakenBy_"+a[i].value).value;b+="&caWhen_"+i+"="+$("caWhen_"+a[i].value).value;b+="&caStatus_"+i+"="+$("caStatus_"+a[i].value).value;c=true}}if(c){new Ajax.Request("InvestFormReview.asp?Ajax=1&doAction=saveAllRCA&pseudoParam="+new Date().getTime(),{method:"POST",parameters:b,onSuccess:function(d){loadCorrectiveActionsRows("moveToDist")}})}else{loadCorrectiveActionsRows("moveToDist")}};