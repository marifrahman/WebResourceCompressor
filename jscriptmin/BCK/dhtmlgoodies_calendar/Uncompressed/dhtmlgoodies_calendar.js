var turnOffYearSpan=false;var weekStartsOnSunday=false;var showWeekNumber=true;var languageCode="en";var calendar_display_time=true;var todayStringFormat="[todayString] [UCFdayString]. [day]. [monthString] [year]";var pathToImages="JScript/images/";var speedOfSelectBoxSliding=200;var intervalSelectBox_minutes=5;var calendar_offsetTop=0;var calendar_offsetLeft=0;var calendarDiv=false;var MSIE=false;var Opera=false;if(navigator.userAgent.indexOf("MSIE")>=0&&navigator.userAgent.indexOf("Opera")<0){MSIE=true}if(navigator.userAgent.indexOf("Opera")>=0){Opera=true}switch(languageCode){case"en":var monthArray=["January","February","March","April","May","June","July","August","September","October","November","December"];var monthArrayShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var dayArray=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];var weekString="Week";var todayString="";break;case"ge":var monthArray=["Januar","Februar","M?rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];var monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"];var dayArray=["Mon","Die","Mit","Don","Fre","Sam","Son"];var weekString="Woche";var todayString="Heute";break;case"no":var monthArray=["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"];var monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"];var dayArray=["Man","Tir","Ons","Tor","Fre","L&oslash;r","S&oslash;n"];var weekString="Uke";var todayString="Dagen i dag er";break;case"nl":var monthArray=["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"];var monthArrayShort=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"];var dayArray=["Ma","Di","Wo","Do","Vr","Za","Zo"];var weekString="Week";var todayString="Vandaag";break;case"es":var monthArray=["Enero","Febrero","Marzo","April","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];var monthArrayShort=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];var dayArray=["Lun","Mar","Mie","Jue","Vie","Sab","Dom"];var weekString="Semana";var todayString="Hoy es";break;case"pt-br":var monthArray=["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];var monthArrayShort=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];var dayArray=["Seg","Ter","Qua","Qui","Sex","S&aacute;b","Dom"];var weekString="Sem.";var todayString="Hoje &eacute;";break;case"fr":var monthArray=["Janvier","F?vrier","Mars","Avril","Mai","Juin","Juillet","Ao?t","Septembre","Octobre","Novembre","D?cembre"];var monthArrayShort=["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Aou","Sep","Oct","Nov","Dec"];var dayArray=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];var weekString="Sem";var todayString="Aujourd'hui";break;case"da":var monthArray=["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"];var monthArrayShort=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"];var dayArray=["man","tirs","ons","tors","fre","l&oslash;r","s&oslash;n"];var weekString="Uge";var todayString="I dag er den";break;case"hu":var monthArray=["Január","Február","Március","??prilis","Május","Június","Július","Augusztus","Szeptember","Október","November","December"];var monthArrayShort=["Jan","Feb","Márc","??pr","Máj","Jún","Júl","Aug","Szep","Okt","Nov","Dec"];var dayArray=["Hé","Ke","Sze","Cs","Pé","Szo","Vas"];var weekString="Hét";var todayString="Mai nap";break;case"it":var monthArray=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];var monthArrayShort=["Gen","Feb","Mar","Apr","Mag","Giu","Lugl","Ago","Set","Ott","Nov","Dic"];var dayArray=["Lun",";Mar","Mer","Gio","Ven","Sab","Dom"];var weekString="Settimana";var todayString="Oggi &egrave; il";break;case"sv":var monthArray=["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"];var monthArrayShort=["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"];var dayArray=["M&aring;n","Tis","Ons","Tor","Fre","L&ouml;r","S&ouml;n"];var weekString="Vecka";var todayString="Idag &auml;r det den";break;case"cz":var monthArray=["leden","&#250;nor","b&#345;ezen","duben","kv&#283;ten","&#269;erven","&#269;ervenec","srpen","z&#225;&#345;&#237;","&#345;&#237;jen","listopad","prosinec"];var monthArrayShort=["led","&#250;n","b&#345;","dub","kv&#283;","&#269;er","&#269;er-ec","srp","z&#225;&#345;","&#345;&#237;j","list","pros"];var dayArray=["Pon","&#218;t","St","&#268;t","P&#225;","So","Ne"];var weekString="t&#253;den";var todayString="";break}if(weekStartsOnSunday){var tempDayName=dayArray[6];for(var theIx=6;theIx>0;theIx--){dayArray[theIx]=dayArray[theIx-1]}dayArray[0]=tempDayName}var daysInMonthArray=[31,28,31,30,31,30,31,31,30,31,30,31];var currentMonth;var currentYear;var currentHour;var currentMinute;var calendarContentDiv;var returnDateTo;var returnFormat;var activeSelectBoxMonth;var activeSelectBoxYear;var activeSelectBoxHour;var activeSelectBoxMinute;var iframeObj=false;var iframeObj2=false;function EIS_FIX_EI1(a){if(!iframeObj2){return}iframeObj2.style.display="block";iframeObj2.style.height=document.getElementById(a).offsetHeight+1;iframeObj2.style.width=document.getElementById(a).offsetWidth;iframeObj2.style.left=getleftPos(document.getElementById(a))+1-calendar_offsetLeft;iframeObj2.style.top=getTopPos(document.getElementById(a))-document.getElementById(a).offsetHeight-calendar_offsetTop}function EIS_Hide_Frame(){if(iframeObj2){iframeObj2.style.display="none"}}var returnDateToYear;var returnDateToMonth;var returnDateToDay;var returnDateToHour;var returnDateToMinute;var inputYear;var inputMonth;var inputDay;var inputHour;var inputMinute;var calendarDisplayTime=false;var selectBoxHighlightColor="#D60808";var selectBoxRolloverBgColor="#E2EBED";var selectBoxMovementInProgress=false;var activeSelectBox=false;function cancelCalendarEvent(){return false}function isLeapYear(a){if(a%400==0||(a%4==0&&a%100!=0)){return true}return false}var activeSelectBoxMonth=false;var activeSelectBoxDirection=false;function highlightMonthYear(){if(activeSelectBoxMonth){activeSelectBoxMonth.className=""}activeSelectBox=this;if(this.className=="monthYearActive"){this.className=""}else{this.className="monthYearActive";activeSelectBoxMonth=this}if(this.innerHTML.indexOf("-")>=0||this.innerHTML.indexOf("+")>=0){if(this.className=="monthYearActive"){selectBoxMovementInProgress=true}else{selectBoxMovementInProgress=false}if(this.innerHTML.indexOf("-")>=0){activeSelectBoxDirection=-1}else{activeSelectBoxDirection=1}}else{selectBoxMovementInProgress=false}}function showMonthDropDown(){if(document.getElementById("monthDropDown").style.display=="block"){document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("monthDropDown").style.display="block";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("monthDropDown")}}}function showYearDropDown(){if(document.getElementById("yearDropDown").style.display=="block"){document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("yearDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("yearDropDown")}}}function showHourDropDown(){if(document.getElementById("hourDropDown").style.display=="block"){document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("hourDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("hourDropDown")}}}function showMinuteDropDown(){if(document.getElementById("minuteDropDown").style.display=="block"){document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("minuteDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("minuteDropDown")}}}function selectMonth(){document.getElementById("calendar_month_txt").innerHTML=this.innerHTML;currentMonth=this.id.replace(/[^\d]/g,"");document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame();for(var a=0;a<monthArray.length;a++){document.getElementById("monthDiv_"+a).style.color=""}this.style.color=selectBoxHighlightColor;activeSelectBoxMonth=this;writeCalendarContent()}function selectHour(){document.getElementById("calendar_hour_txt").innerHTML=this.innerHTML;currentHour=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxHour){activeSelectBoxHour.style.color=""}activeSelectBoxHour=this;this.style.color=selectBoxHighlightColor}function selectMinute(){document.getElementById("calendar_minute_txt").innerHTML=this.innerHTML;currentMinute=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxMinute){activeSelectBoxMinute.style.color=""}activeSelectBoxMinute=this;this.style.color=selectBoxHighlightColor}function selectYear(){document.getElementById("calendar_year_txt").innerHTML=this.innerHTML;currentYear=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxYear){activeSelectBoxYear.style.color=""}activeSelectBoxYear=this;this.style.color=selectBoxHighlightColor;writeCalendarContent()}function switchMonth(){if(this.src.indexOf("left")>=0){currentMonth=currentMonth-1;if(currentMonth<0){currentMonth=11;currentYear=currentYear-1}}else{currentMonth=currentMonth+1;if(currentMonth>11){currentMonth=0;currentYear=currentYear/1+1}}writeCalendarContent()}function createMonthDiv(){var a=document.createElement("DIV");a.className="monthYearPicker";a.id="monthPicker";for(var b=0;b<monthArray.length;b++){var c=document.createElement("DIV");c.innerHTML=monthArray[b];c.onmouseover=highlightMonthYear;c.onmouseout=highlightMonthYear;c.onclick=selectMonth;c.id="monthDiv_"+b;c.style.width="56px";c.onselectstart=cancelCalendarEvent;a.appendChild(c);if(currentMonth&&currentMonth==b){c.style.color=selectBoxHighlightColor;activeSelectBoxMonth=c}}return a}function changeSelectBoxYear(a,b){if(!b){b=this}var f=b.parentNode.getElementsByTagName("DIV");if(b.innerHTML.indexOf("-")>=0){var d=f[1].innerHTML/1-1;if(activeSelectBoxYear){activeSelectBoxYear.style.color=""}}else{var d=f[1].innerHTML/1+1;if(activeSelectBoxYear){activeSelectBoxYear.style.color=""}}for(var c=1;c<f.length-1;c++){f[c].innerHTML=d+c-1;f[c].id="yearDiv"+(d/1+c/1-1)}if(activeSelectBoxYear){activeSelectBoxYear.style.color="";if(document.getElementById("yearDiv"+currentYear)){activeSelectBoxYear=document.getElementById("yearDiv"+currentYear);activeSelectBoxYear.style.color=selectBoxHighlightColor}}}function changeSelectBoxHour(a,c){if(!c){c=this}var b=c.parentNode.getElementsByTagName("DIV");if(c.innerHTML.indexOf("-")>=0){var g=b[1].innerHTML/1-1;if(g<0){g=0}if(activeSelectBoxHour){activeSelectBoxHour.style.color=""}}else{var g=b[1].innerHTML/1+1;if(g>14){g=14}if(activeSelectBoxHour){activeSelectBoxHour.style.color=""}}var f="";for(var d=1;d<b.length-1;d++){if((g/1+d/1)<11){f="0"}else{f=""}b[d].innerHTML=f+(g+d-1);b[d].id="hourDiv"+(g/1+d/1-1)}if(activeSelectBoxHour){activeSelectBoxHour.style.color="";if(document.getElementById("hourDiv"+currentHour)){activeSelectBoxHour=document.getElementById("hourDiv"+currentHour);activeSelectBoxHour.style.color=selectBoxHighlightColor}}}function updateYearDiv(){var d=5;if(turnOffYearSpan){d=0}var a=document.getElementById("yearDropDown");var c=a.getElementsByTagName("DIV");for(var b=1;b<c.length-1;b++){c[b].innerHTML=currentYear/1-d+b;if(currentYear==(currentYear/1-d+b)){c[b].style.color=selectBoxHighlightColor;activeSelectBoxYear=c[b]}else{c[b].style.color=""}}}function updateMonthDiv(){for(no=0;no<12;no++){document.getElementById("monthDiv_"+no).style.color=""}document.getElementById("monthDiv_"+currentMonth).style.color=selectBoxHighlightColor;activeSelectBoxMonth=document.getElementById("monthDiv_"+currentMonth)}function updateHourDiv(){var b=document.getElementById("hourDropDown");var c=b.getElementsByTagName("DIV");var a=0;if((currentHour/1-6+1)<0){a=(currentHour/1-6+1)*-1}for(var d=1;d<c.length-1;d++){var e="";if((currentHour/1-6+d+a)<10){e="0"}c[d].innerHTML=e+(currentHour/1-6+d+a);if(currentHour==(currentHour/1-6+d)){c[d].style.color=selectBoxHighlightColor;activeSelectBoxHour=c[d]}else{c[d].style.color=""}}}function updateMinuteDiv(){for(no=0;no<60;no+=intervalSelectBox_minutes){var a="";if(no<10){a="0"}document.getElementById("minuteDiv_"+a+no).style.color=""}if(document.getElementById("minuteDiv_"+currentMinute)){document.getElementById("minuteDiv_"+currentMinute).style.color=selectBoxHighlightColor;activeSelectBoxMinute=document.getElementById("minuteDiv_"+currentMinute)}}function createYearDiv(){if(!document.getElementById("yearDropDown")){var b=document.createElement("DIV");b.className="monthYearPicker"}else{var b=document.getElementById("yearDropDown");var g=b.getElementsByTagName("DIV");for(var c=0;c<g.length;c++){g[c].parentNode.removeChild(g[c])}}var a=new Date();if(currentYear){a.setFullYear(currentYear)}var e=a.getFullYear()/1-5;var h=10;if(!turnOffYearSpan){var f=document.createElement("DIV");f.innerHTML="&nbsp;&nbsp;- ";f.onclick=changeSelectBoxYear;f.onmouseover=highlightMonthYear;f.onmouseout=function(){selectBoxMovementInProgress=false};f.onselectstart=cancelCalendarEvent;b.appendChild(f)}else{e=a.getFullYear()/1-0;h=2}for(var c=e;c<(e+h);c++){var f=document.createElement("DIV");f.innerHTML=c;f.onmouseover=highlightMonthYear;f.onmouseout=highlightMonthYear;f.onclick=selectYear;f.id="yearDiv"+c;f.onselectstart=cancelCalendarEvent;b.appendChild(f);if(currentYear&&currentYear==c){f.style.color=selectBoxHighlightColor;activeSelectBoxYear=f}}if(!turnOffYearSpan){var f=document.createElement("DIV");f.innerHTML="&nbsp;&nbsp;+ ";f.onclick=changeSelectBoxYear;f.onmouseover=highlightMonthYear;f.onmouseout=function(){selectBoxMovementInProgress=false};f.onselectstart=cancelCalendarEvent;b.appendChild(f)}return b}function slideCalendarSelectBox(){if(selectBoxMovementInProgress){if(activeSelectBox.parentNode.id=="hourDropDown"){changeSelectBoxHour(false,activeSelectBox)}if(activeSelectBox.parentNode.id=="yearDropDown"){changeSelectBoxYear(false,activeSelectBox)}}setTimeout("slideCalendarSelectBox()",speedOfSelectBoxSliding)}function createHourDiv(){if(!document.getElementById("hourDropDown")){var a=document.createElement("DIV");a.className="monthYearPicker"}else{var a=document.getElementById("hourDropDown");var f=a.getElementsByTagName("DIV");for(var b=0;b<f.length;b++){f[b].parentNode.removeChild(f[b])}}if(!currentHour){currentHour=0}var d=currentHour/1;if(d>14){d=14}var e=document.createElement("DIV");e.innerHTML="&nbsp;&nbsp;- ";e.onclick=changeSelectBoxHour;e.onmouseover=highlightMonthYear;e.onmouseout=function(){selectBoxMovementInProgress=false};e.onselectstart=cancelCalendarEvent;a.appendChild(e);for(var b=d;b<d+10;b++){var c="";if(b/1<10){c="0"}var e=document.createElement("DIV");e.innerHTML=c+b;e.onmouseover=highlightMonthYear;e.onmouseout=highlightMonthYear;e.onclick=selectHour;e.id="hourDiv"+b;e.onselectstart=cancelCalendarEvent;a.appendChild(e);if(currentYear&&currentYear==b){e.style.color=selectBoxHighlightColor;activeSelectBoxYear=e}}var e=document.createElement("DIV");e.innerHTML="&nbsp;&nbsp;+ ";e.onclick=changeSelectBoxHour;e.onmouseover=highlightMonthYear;e.onmouseout=function(){selectBoxMovementInProgress=false};e.onselectstart=cancelCalendarEvent;a.appendChild(e);return a}function createMinuteDiv(){if(!document.getElementById("minuteDropDown")){var a=document.createElement("DIV");a.className="monthYearPicker"}else{var a=document.getElementById("minuteDropDown");var f=a.getElementsByTagName("DIV");for(var b=0;b<f.length;b++){f[b].parentNode.removeChild(f[b])}}var d=0;var c="";for(var b=d;b<60;b+=intervalSelectBox_minutes){if(b<10){c="0"}else{c=""}var e=document.createElement("DIV");e.innerHTML=c+b;e.onmouseover=highlightMonthYear;e.onmouseout=highlightMonthYear;e.onclick=selectMinute;e.id="minuteDiv_"+c+b;e.onselectstart=cancelCalendarEvent;a.appendChild(e);if(currentYear&&currentYear==b){e.style.color=selectBoxHighlightColor;activeSelectBoxYear=e}}return a}function highlightSelect(){if(this.className=="selectBoxTime"){this.className="selectBoxTimeOver";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time_over.gif"}else{if(this.className=="selectBoxTimeOver"){this.className="selectBoxTime";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time.gif"}}if(this.className=="selectBox"){this.className="selectBoxOver";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_over.gif"}else{if(this.className=="selectBoxOver"){this.className="selectBox";this.getElementsByTagName("IMG")[0].src=pathToImages+"down.gif"}}}function highlightArrow(){if(this.src.indexOf("over")>=0){if(this.src.indexOf("left")>=0){this.src=pathToImages+"left.gif"}if(this.src.indexOf("right")>=0){this.src=pathToImages+"right.gif"}}else{if(this.src.indexOf("left")>=0){this.src=pathToImages+"left_over.gif"}if(this.src.indexOf("right")>=0){this.src=pathToImages+"right_over.gif"}}}function highlightClose(){if(this.src.indexOf("over")>=0){this.src=pathToImages+"close.gif"}else{this.src=pathToImages+"close_over.gif"}}function closeCalendar(){document.getElementById("yearDropDown").style.display="none";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";calendarDiv.style.display="none";if(iframeObj){iframeObj.style.display="none";EIS_Hide_Frame()}if(activeSelectBoxMonth){activeSelectBoxMonth.className=""}if(activeSelectBoxYear){activeSelectBoxYear.className=""}}function writeTopBar(){var g=document.createElement("DIV");g.className="topBar";g.id="topBar";calendarDiv.appendChild(g);var b=document.createElement("DIV");b.style.marginRight="1px";var a=document.createElement("IMG");a.src=pathToImages+"left.gif";a.onmouseover=highlightArrow;a.onclick=switchMonth;a.onmouseout=highlightArrow;b.appendChild(a);g.appendChild(b);if(Opera){b.style.width="16px"}var e=document.createElement("DIV");e.style.marginRight="1px";var a=document.createElement("IMG");a.src=pathToImages+"right.gif";a.onclick=switchMonth;a.onmouseover=highlightArrow;a.onmouseout=highlightArrow;e.appendChild(a);if(Opera){e.style.width="16px"}g.appendChild(e);var c=document.createElement("DIV");c.id="monthSelect";c.onmouseover=highlightSelect;c.onmouseout=highlightSelect;c.onclick=showMonthDropDown;var f=document.createElement("SPAN");f.innerHTML=monthArray[currentMonth];f.id="calendar_month_txt";c.appendChild(f);var a=document.createElement("IMG");a.src=pathToImages+"down.gif";a.style.position="absolute";a.style.right="0px";c.appendChild(a);c.className="selectBox";if(Opera){a.style.cssText="float:right;position:relative";a.style.position="relative";a.style.styleFloat="right"}g.appendChild(c);var d=createMonthDiv();d.style.left="37px";d.style.top=c.offsetTop+c.offsetHeight+1+"px";d.style.width="60px";d.id="monthDropDown";calendarDiv.appendChild(d);var h=document.createElement("DIV");h.onmouseover=highlightSelect;h.onmouseout=highlightSelect;h.onclick=showYearDropDown;var f=document.createElement("SPAN");f.innerHTML=currentYear;f.id="calendar_year_txt";h.appendChild(f);g.appendChild(h);var a=document.createElement("IMG");a.src=pathToImages+"down.gif";h.appendChild(a);h.className="selectBox";if(Opera){h.style.width="50px";a.style.cssText="float:right";a.style.position="relative";a.style.styleFloat="right"}var i=createYearDiv();i.style.left="113px";i.style.top=c.offsetTop+c.offsetHeight+1+"px";i.style.width="35px";i.id="yearDropDown";calendarDiv.appendChild(i);var a=document.createElement("IMG");a.src=pathToImages+"close.gif";a.style.styleFloat="right";a.onmouseover=highlightClose;a.onmouseout=highlightClose;a.onclick=closeCalendar;g.appendChild(a);if(!document.all){a.style.position="absolute";a.style.right="2px"}}function writeCalendarContent(){var a=true;if(!calendarContentDiv){calendarContentDiv=document.createElement("DIV");calendarDiv.appendChild(calendarContentDiv);a=false}currentMonth=currentMonth/1;var g=new Date();g.setFullYear(currentYear);g.setDate(1);g.setMonth(currentMonth);var i=g.getDay();if(!weekStartsOnSunday){if(i==0){i=7}i--}document.getElementById("calendar_year_txt").innerHTML=currentYear;document.getElementById("calendar_month_txt").innerHTML=monthArray[currentMonth];document.getElementById("calendar_hour_txt").innerHTML=currentHour/1>9?currentHour:"0"+currentHour;document.getElementById("calendar_minute_txt").innerHTML=currentMinute/1>9?currentMinute:"0"+currentMinute;var j=calendarContentDiv.getElementsByTagName("TABLE");if(j.length>0){calendarContentDiv.removeChild(j[0])}var b=document.createElement("TABLE");b.width="100%";b.cellSpacing="0";calendarContentDiv.appendChild(b);var c=document.createElement("TBODY");b.appendChild(c);var l=c.insertRow(-1);l.className="calendar_week_row";if(showWeekNumber){var e=l.insertCell(-1);e.innerHTML=weekString;e.className="calendar_week_column";e.style.backgroundColor=selectBoxRolloverBgColor}for(var k=0;k<dayArray.length;k++){var e=l.insertCell(-1);e.innerHTML=dayArray[k]}var l=c.insertRow(-1);if(showWeekNumber){var e=l.insertCell(-1);e.className="calendar_week_column";e.style.backgroundColor=selectBoxRolloverBgColor;var m=getWeek(currentYear,currentMonth,1);e.innerHTML=m}for(var k=0;k<i;k++){var e=l.insertCell(-1);e.innerHTML="&nbsp;"}var f=i;var h=daysInMonthArray[currentMonth];if(h==28){if(isLeapYear(currentYear)){h=29}}for(var k=1;k<=h;k++){g.setDate(k-1);if(f>0&&f%7==0){var l=c.insertRow(-1);if(showWeekNumber){var e=l.insertCell(-1);e.className="calendar_week_column";var m=getWeek(currentYear,currentMonth,k);e.innerHTML=m;e.style.backgroundColor=selectBoxRolloverBgColor}}var e=l.insertCell(-1);if(currentYear==inputYear&&currentMonth==inputMonth&&k==inputDay){e.className="activeDay"}e.innerHTML=k;e.onclick=pickDate;f++}if(!document.all){if(calendarContentDiv.offsetHeight){document.getElementById("topBar").style.top=calendarContentDiv.offsetHeight+document.getElementById("timeBar").offsetHeight+document.getElementById("topBar").offsetHeight-1+"px"}else{document.getElementById("topBar").style.top="";document.getElementById("topBar").style.bottom="0px"}}if(iframeObj){if(!a){setTimeout("resizeIframe()",350)}else{setTimeout("resizeIframe()",10)}}}function resizeIframe(){iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj.style.height=calendarDiv.offsetHeight+"px"}function pickTodaysDate(){var a=new Date();currentMonth=a.getMonth();currentYear=a.getFullYear();pickDate(false,a.getDate())}function pickDate(b,c){var d=currentMonth/1+1;if(d<10){d="0"+d}var a;if(!c&&this){a=this.innerHTML}else{a=c}if(a/1<10){a="0"+a}if(returnFormat){returnFormat=returnFormat.replace("dd",a);returnFormat=returnFormat.replace("mm",d);returnFormat=returnFormat.replace("yyyy",currentYear);returnFormat=returnFormat.replace("hh",currentHour);returnFormat=returnFormat.replace("ii",currentMinute);returnFormat=returnFormat.replace("d",a/1);returnFormat=returnFormat.replace("m",d/1);returnDateTo.value=returnFormat;try{returnDateTo.onchange()}catch(b){}}else{for(var f=0;f<returnDateToYear.options.length;f++){if(returnDateToYear.options[f].value==currentYear){returnDateToYear.selectedIndex=f;break}}for(var f=0;f<returnDateToMonth.options.length;f++){if(returnDateToMonth.options[f].value==parseFloat(d)){returnDateToMonth.selectedIndex=f;break}}for(var f=0;f<returnDateToDay.options.length;f++){if(returnDateToDay.options[f].value==parseFloat(a)){returnDateToDay.selectedIndex=f;break}}if(calendarDisplayTime){for(var f=0;f<returnDateToHour.options.length;f++){if(returnDateToHour.options[f].value==parseFloat(currentHour)){returnDateToHour.selectedIndex=f;break}}for(var f=0;f<returnDateToMinute.options.length;f++){if(returnDateToMinute.options[f].value==parseFloat(currentMinute)){returnDateToMinute.selectedIndex=f;break}}}}closeCalendar()}function getWeek(k,i,e){if(!weekStartsOnSunday){e=(e/1)}else{e=(e/1)+1}k=k/1;i=i/1+1;var b=Math.floor((14-(i))/12);var j=k+4800-b;var h=(i)+(12*b)-3;var f=e+Math.floor(((153*h)+2)/5)+(365*j)+Math.floor(j/4)-Math.floor(j/100)+Math.floor(j/400)-32045;var d=(f+31741-(f%7))%146097%36524%1461;var g=Math.floor(d/1460);var c=((d-g)%365)+g;NumberOfWeek=Math.floor(c/7)+1;return NumberOfWeek}function writeTimeBar(){var h=document.createElement("DIV");h.id="timeBar";h.className="timeBar";var g=document.createElement("DIV");g.innerHTML="Time:";var a=document.createElement("DIV");a.onmouseover=highlightSelect;a.onmouseout=highlightSelect;a.onclick=showHourDropDown;a.style.width="30px";var f=document.createElement("SPAN");f.innerHTML=currentHour;f.id="calendar_hour_txt";a.appendChild(f);h.appendChild(a);var c=document.createElement("IMG");c.src=pathToImages+"down_time.gif";a.appendChild(c);a.className="selectBoxTime";if(Opera){a.style.width="30px";c.style.cssText="float:right";c.style.position="relative";c.style.styleFloat="right"}var b=createHourDiv();b.style.left="130px";b.style.width="35px";b.id="hourDropDown";calendarDiv.appendChild(b);var d=document.createElement("DIV");d.onmouseover=highlightSelect;d.onmouseout=highlightSelect;d.onclick=showMinuteDropDown;d.style.width="30px";var f=document.createElement("SPAN");f.innerHTML=currentMinute;f.id="calendar_minute_txt";d.appendChild(f);h.appendChild(d);var c=document.createElement("IMG");c.src=pathToImages+"down_time.gif";d.appendChild(c);d.className="selectBoxTime";if(Opera){d.style.width="30px";c.style.cssText="float:right";c.style.position="relative";c.style.styleFloat="right"}var e=createMinuteDiv();e.style.left="167px";e.style.width="35px";e.id="minuteDropDown";calendarDiv.appendChild(e);return h}function writeBottomBar(){var c=new Date();var a=document.createElement("DIV");a.id="bottomBar";a.style.cursor="pointer";a.className="todaysDate";var f=document.createElement("DIV");f.onclick=pickTodaysDate;f.id="todaysDateString";f.style.width=(calendarDiv.offsetWidth-95)+"px";var e=c.getDay();if(!weekStartsOnSunday){if(e==0){e=7}e--}var b=todayStringFormat;b=b.replace("[monthString]",monthArrayShort[c.getMonth()]);b=b.replace("[day]",c.getDate());b=b.replace("[year]",c.getFullYear());b=b.replace("[dayString]",dayArray[e].toLowerCase());b=b.replace("[UCFdayString]",dayArray[e]);b=b.replace("[todayString]",todayString);f.innerHTML=todayString+": "+c.getDate()+". "+monthArrayShort[c.getMonth()]+", "+c.getFullYear();f.innerHTML=b;a.appendChild(f);var g=writeTimeBar();a.appendChild(g);calendarDiv.appendChild(a)}function getTopPos(a){var b=a.offsetTop+a.offsetHeight;while((a=a.offsetParent)!=null){b+=a.offsetTop}return b+calendar_offsetTop}function getleftPos(a){var b=a.offsetLeft;while((a=a.offsetParent)!=null){b+=a.offsetLeft}return b+calendar_offsetLeft}function positionCalendar(a){calendarDiv.style.left=getleftPos(a)+"px";calendarDiv.style.top=getTopPos(a)+"px";if(iframeObj){iframeObj.style.left=calendarDiv.style.left;iframeObj.style.top=calendarDiv.style.top;iframeObj2.style.left=calendarDiv.style.left;iframeObj2.style.top=calendarDiv.style.top}}function initCalendar(){if(MSIE){iframeObj=document.createElement("IFRAME");iframeObj.style.filter="alpha(opacity=0)";iframeObj.style.position="absolute";iframeObj.border="0px";iframeObj.style.border="0px";iframeObj.style.backgroundColor="#FF0000";iframeObj2=document.createElement("IFRAME");iframeObj2.style.position="absolute";iframeObj2.border="0px";iframeObj2.style.border="0px";iframeObj2.style.height="1px";iframeObj2.style.width="1px";iframeObj2.src="blank.html";iframeObj.src="blank.html";document.body.appendChild(iframeObj2);document.body.appendChild(iframeObj)}calendarDiv=document.createElement("DIV");calendarDiv.id="calendarDiv";calendarDiv.style.zIndex=1000;slideCalendarSelectBox();document.body.appendChild(calendarDiv);writeBottomBar();writeTopBar();if(!currentYear){var a=new Date();currentMonth=a.getMonth();currentYear=a.getFullYear()}writeCalendarContent()}function setTimeProperties(){if(!calendarDisplayTime){document.getElementById("timeBar").style.display="none";document.getElementById("timeBar").style.visibility="hidden";document.getElementById("todaysDateString").style.width="100%"}else{document.getElementById("timeBar").style.display="block";document.getElementById("timeBar").style.visibility="visible";document.getElementById("hourDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.right="50px";document.getElementById("hourDropDown").style.right="50px";document.getElementById("todaysDateString").style.width="115px"}}function calendarSortItems(c,d){return c/1-d/1}function displayDOB(c,b,a){if(c.value==""){c.value="01-01-1990"}displayCalendar(c,b,a)}function displayCalendar(k,g,a,e,r){if(e){calendarDisplayTime=true}else{calendarDisplayTime=false}if(k.value.length>6){if(!k.value.match(/^[0-9]*?$/gi)){var l=k.value.split(/[^0-9]/gi);var o=new Object();o.m=g.indexOf("mm");if(o.m==-1){o.m=g.indexOf("m")}o.d=g.indexOf("dd");if(o.d==-1){o.d=g.indexOf("d")}o.y=g.indexOf("yyyy");o.h=g.indexOf("hh");o.i=g.indexOf("ii");this.initialHour="00";this.initialMinute="00";var f=["y","m","d","h","i"];var p=["currentYear","currentMonth","inputDay","currentHour","currentMinute"];var q=[4,2,2,2,2];for(var j=0;j<f.length;j++){if(o[f[j]]>=0){window[p[j]]=k.value.substr(o[f[j]],q[j])/1}}currentMonth--}else{var n=g.indexOf("mm");currentMonth=k.value.substr(n,2)/1-1;var s=g.indexOf("yyyy");currentYear=k.value.substr(s,4);var c=g.indexOf("dd");tmpDay=k.value.substr(c,2);var h=g.indexOf("hh");if(h>=0){tmpHour=k.value.substr(h,2);currentHour=tmpHour;if(currentHour.length==1){currentHour="0"}}else{currentHour="00"}var m=g.indexOf("ii");if(m>=0){tmpMinute=k.value.substr(m,2);currentMinute=tmpMinute}else{currentMinute="00"}}}else{var b=new Date();currentMonth=b.getMonth();currentYear=b.getFullYear();currentHour="08";currentMinute="00";inputDay=b.getDate()/1}inputYear=currentYear;inputMonth=currentMonth;if(!calendarDiv){initCalendar()}else{if(calendarDiv.style.display=="block"){closeCalendar();return false}writeCalendarContent()}returnFormat=g;returnDateTo=k;positionCalendar(a);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height="140px";iframeObj.style.width="195px";iframeObj2.style.display="";iframeObj2.style.height="140px";iframeObj2.style.width="195px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateMinuteDiv();updateHourDiv()}function displayCalendarSelectBox(f,e,b,c,d,a){if(!c){calendarDisplayTime=false}else{calendarDisplayTime=true}currentMonth=e.options[e.selectedIndex].value/1-1;currentYear=f.options[f.selectedIndex].value;if(c){currentHour=c.options[c.selectedIndex].value;inputHour=currentHour/1}if(d){currentMinute=d.options[d.selectedIndex].value;inputMinute=currentMinute/1}inputYear=f.options[f.selectedIndex].value;inputMonth=e.options[e.selectedIndex].value/1-1;inputDay=b.options[b.selectedIndex].value/1;if(!calendarDiv){initCalendar()}else{writeCalendarContent()}returnDateToYear=f;returnDateToMonth=e;returnDateToDay=b;returnDateToHour=c;returnDateToMinute=d;returnFormat=false;returnDateTo=false;positionCalendar(a);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height=calendarDiv.offsetHeight+"px";iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj2.style.display="";iframeObj2.style.height=calendarDiv.offsetHeight+"px";iframeObj2.style.width=calendarDiv.offsetWidth+"px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateHourDiv();updateMinuteDiv()};