var jscolor={bindAuto:true,bindClass:"color",dir:"",install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){if(jscolor.bindAuto){jscolor.bind()}},getDir:function(){if(!jscolor.dir){var a=jscolor.detectDir();jscolor.dir=a!=false?a:"jscolor/"}return jscolor.dir},detectDir:function(){var a=location.href;var b=document.getElementsByTagName("base");for(var c=0;c<b.length;c++){if(b[c].href){a=b[c].href}}var b=document.getElementsByTagName("script");for(var c=0;c<b.length;c++){if(b[c].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(b[c].src)){var d=new jscolor.URI(b[c].src);var f=d.toAbsolute(a);f.path=f.path.replace(/[^\/]+$/,"");delete f.query;delete f.fragment;return f.toString()}}return false},bind:function(){var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i");var e=document.getElementsByTagName("input");for(var i=0;i<e.length;i++){var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3]){try{eval("prop="+m[3])}catch(eInvalidProp){}}e[i].color=new jscolor.color(e[i],prop)}}},fetchElement:function(a){return typeof(a)=="string"?document.getElementById(a):a},addEvent:function(a,b,c){if(a.addEventListener){return a.addEventListener(b,c,false)}else{if(a.attachEvent){return a.attachEvent("on"+b,c)}else{return false}}},fireEvent:function(a,c){if(!a){return false}else{if(document.createEventObject){var b=document.createEventObject();return a.fireEvent("on"+c,b)}else{if(document.createEvent){var b=document.createEvent("HTMLEvents");b.initEvent(c,true,true);return a.dispatchEvent(b)}else{if(a["on"+c]){return a["on"+c]()}else{return false}}}}},getElementPos:function(a){var b=a,c=a;var d=0,f=0;if(b.offsetParent){do{d+=b.offsetLeft;f+=b.offsetTop}while(b=b.offsetParent)}while((c=c.parentNode)&&c.nodeName!="BODY"){d-=c.scrollLeft;f-=c.scrollTop}return[d,f]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getMousePos:function(a){if(!a){var a=window.event}if(typeof a.pageX=="number"){return[a.pageX,a.pageY]}else{if(typeof a.clientX=="number"){return[a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.clientY+document.body.scrollTop+document.documentElement.scrollTop]}}},getViewPos:function(){if(typeof window.pageYOffset=="number"){return[window.pageXOffset,window.pageYOffset]}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){return[document.body.scrollLeft,document.body.scrollTop]}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]}else{return[0,0]}}}},getViewSize:function(){if(typeof window.innerWidth=="number"){return[window.innerWidth,window.innerHeight]}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){return[document.body.clientWidth,document.body.clientHeight]}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){return[document.documentElement.clientWidth,document.documentElement.clientHeight]}else{return[0,0]}}}},URI:function(b){this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(d){var c=d.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=c[3]?c[2]:null;this.authority=c[5]?c[6]:null;this.path=c[7];this.query=c[9]?c[10]:null;this.fragment=c[12]?c[13]:null;return this};this.toString=function(){var c="";if(this.scheme!=null){c=c+this.scheme+":"}if(this.authority!=null){c=c+"//"+this.authority}if(this.path!=null){c=c+this.path}if(this.query!=null){c=c+"?"+this.query}if(this.fragment!=null){c=c+"#"+this.fragment}return c};this.toAbsolute=function(c){var c=new jscolor.URI(c);var d=this;var e=new jscolor.URI;if(c.scheme==null){return false}if(d.scheme!=null&&d.scheme.toLowerCase()==c.scheme.toLowerCase()){d.scheme=null}if(d.scheme!=null){e.scheme=d.scheme;e.authority=d.authority;e.path=a(d.path);e.query=d.query}else{if(d.authority!=null){e.authority=d.authority;e.path=a(d.path);e.query=d.query}else{if(d.path==""){e.path=c.path;if(d.query!=null){e.query=d.query}else{e.query=c.query}}else{if(d.path.substr(0,1)=="/"){e.path=a(d.path)}else{if(c.authority!=null&&c.path==""){e.path="/"+d.path}else{e.path=c.path.replace(/[^\/]+$/,"")+d.path}e.path=a(e.path)}e.query=d.query}e.authority=c.authority}e.scheme=c.scheme}e.fragment=d.fragment;return e};function a(d){var c="";while(d){if(d.substr(0,3)=="../"||d.substr(0,2)=="./"){d=d.replace(/^\.+/,"").substr(1)}else{if(d.substr(0,3)=="/./"||d=="/."){d="/"+d.substr(3)}else{if(d.substr(0,4)=="/../"||d=="/.."){d="/"+d.substr(4);c=c.replace(/\/?[^\/]*$/,"")}else{if(d=="."||d==".."){d=""}else{var e=d.match(/^\/?[^\/]*/)[0];d=d.substr(e.length);c=c+e}}}}}return c}if(b){this.parse(b)}},color:function(A,s){this.required=true;this.adjust=true;this.hash=true;this.caps=true;this.valueElement=A;this.styleElement=A;this.hsv=[0,1,0];this.rgb=[0,0,0];this.picker=true;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerFace=10;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=10000;for(var o in s){this[o]=s[o]}this.hidePicker=function(){if(i()){v()}};this.showPicker=function(){if(!i()){var M=jscolor.getElementPos(A);var N=jscolor.getElementSize(A);var O=jscolor.getViewPos();var P=jscolor.getViewSize();var L=[2*this.pickerBorder+4*this.pickerInset+2*this.pickerFace+F+2*E+G,2*this.pickerBorder+2*this.pickerInset+2*this.pickerFace+e];var p,H,I;switch(this.pickerPosition.toLowerCase()){case"left":p=1;H=0;I=-1;break;case"right":p=1;H=0;I=1;break;case"top":p=0;H=1;I=-1;break;default:p=0;H=1;I=1;break}var J=(N[H]+L[H])/2;var K=[-O[p]+M[p]+L[p]>P[p]?(-O[p]+M[p]+N[p]/2>P[p]/2&&M[p]+N[p]-L[p]>=0?M[p]+N[p]-L[p]:M[p]):M[p],-O[H]+M[H]+N[H]+L[H]-J+J*I>P[H]?(-O[H]+M[H]+N[H]/2>P[H]/2&&M[H]+N[H]-J-J*I>=0?M[H]+N[H]-J-J*I:M[H]+N[H]-J+J*I):(M[H]+N[H]-J+J*I>=0?M[H]+N[H]-J+J*I:M[H]+N[H]-J-J*I)];d(K[p],K[H])}};this.importColor=function(){if(!D){this.exportColor()}else{if(!this.adjust){if(!this.fromString(D.value,m)){z.style.backgroundColor=z.jscStyle.backgroundColor;z.style.color=z.jscStyle.color;this.exportColor(m|l)}}else{if(!this.required&&/^\s*$/.test(D.value)){D.value="";z.style.backgroundColor=z.jscStyle.backgroundColor;z.style.color=z.jscStyle.color;this.exportColor(m|l)}else{if(this.fromString(D.value)){}else{this.exportColor()}}}}};this.exportColor=function(p){if(!(p&m)&&D){var H=this.toString();if(this.caps){H=H.toUpperCase()}if(this.hash){H="#"+H}D.value=H}if(!(p&l)&&z){z.style.backgroundColor="#"+this.toString();z.style.color=0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]<0.5?"#FFF":"#000"}if(!(p&j)&&i()){t()}if(!(p&k)&&i()){u()}};this.fromHSV=function(H,I,J,p){H<0&&(H=0)||H>6&&(H=6);I<0&&(I=0)||I>1&&(I=1);J<0&&(J=0)||J>1&&(J=1);this.rgb=h(H==null?this.hsv[0]:(this.hsv[0]=H),I==null?this.hsv[1]:(this.hsv[1]=I),J==null?this.hsv[2]:(this.hsv[2]=J));this.exportColor(p)};this.fromRGB=function(K,I,p,H){K<0&&(K=0)||K>1&&(K=1);I<0&&(I=0)||I>1&&(I=1);p<0&&(p=0)||p>1&&(p=1);var J=w(K==null?this.rgb[0]:(this.rgb[0]=K),I==null?this.rgb[1]:(this.rgb[1]=I),p==null?this.rgb[2]:(this.rgb[2]=p));if(J[0]!=null){this.hsv[0]=J[0]}if(J[2]!=0){this.hsv[1]=J[1]}this.hsv[2]=J[2];this.exportColor(H)};this.fromString=function(H,p){var I=H.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(!I){return false}else{if(I[1].length==6){this.fromRGB(parseInt(I[1].substr(0,2),16)/255,parseInt(I[1].substr(2,2),16)/255,parseInt(I[1].substr(4,2),16)/255,p)}else{this.fromRGB(parseInt(I[1].charAt(0)+I[1].charAt(0),16)/255,parseInt(I[1].charAt(1)+I[1].charAt(1),16)/255,parseInt(I[1].charAt(2)+I[1].charAt(2),16)/255,p)}return true}};this.toString=function(){return((256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1))};function w(L,H,p){var K=Math.min(Math.min(L,H),p);var M=Math.max(Math.max(L,H),p);var J=M-K;if(J==0){return[null,0,M]}var I=L==K?3+(p-H)/J:(H==K?5+(L-p)/J:1+(H-L)/J);return[I==6?0:I,J/M,M]}function h(H,L,M){if(H==null){return[M,M,M]}var I=Math.floor(H);var p=I%2?H-I:1-(H-I);var J=M*(1-L);var K=M*(1-L*p);switch(I){case 6:case 0:return[M,K,J];case 1:return[K,M,J];case 2:return[J,M,K];case 3:return[J,K,M];case 4:return[K,J,M];case 5:return[M,J,K]}}function v(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function d(N,O){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div")};for(var I=0,M=4;I<e;I+=M){var L=document.createElement("div");L.style.height=M+"px";L.style.fontSize="1px";L.style.lineHeight="0";jscolor.picker.sld.appendChild(L)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.boxB.appendChild(jscolor.picker.box)}var K=jscolor.picker;q=[N+B.pickerBorder+B.pickerFace+B.pickerInset,O+B.pickerBorder+B.pickerFace+B.pickerInset];r=[null,O+B.pickerBorder+B.pickerFace+B.pickerInset];K.box.onmouseup=K.box.onmouseout=function(){A.focus()};K.box.onmousedown=function(){a=true};K.box.onmousemove=function(p){f&&x(p);g&&y(p)};K.padM.onmouseup=K.padM.onmouseout=function(){if(f){f=false;jscolor.fireEvent(D,"change")}};K.padM.onmousedown=function(p){f=true;x(p)};K.sldM.onmouseup=K.sldM.onmouseout=function(){if(g){g=false;jscolor.fireEvent(D,"change")}};K.sldM.onmousedown=function(p){g=true;y(p)};K.box.style.width=4*B.pickerInset+2*B.pickerFace+F+2*E+G+"px";K.box.style.height=2*B.pickerInset+2*B.pickerFace+e+"px";K.boxB.style.position="absolute";K.boxB.style.clear="both";K.boxB.style.left=N+"px";K.boxB.style.top=O+"px";K.boxB.style.zIndex=B.pickerZIndex;K.boxB.style.border=B.pickerBorder+"px solid";K.boxB.style.borderColor=B.pickerBorderColor;K.boxB.style.background=B.pickerFaceColor;switch(n){case 0:var J="hs.png";break;case 1:var J="hv.png";break}K.pad.style.width=F+"px";K.pad.style.height=e+"px";K.pad.style.background="url('"+jscolor.getDir()+J+"') 0 0 no-repeat";K.padB.style.position="absolute";K.padB.style.left=B.pickerFace+"px";K.padB.style.top=B.pickerFace+"px";K.padB.style.border=B.pickerInset+"px solid";K.padB.style.borderColor=B.pickerInsetColor;K.padM.style.position="absolute";K.padM.style.left="0";K.padM.style.top="0";K.padM.style.width=B.pickerFace+2*B.pickerInset+F+E+"px";K.padM.style.height=K.box.style.height;K.padM.style.cursor="crosshair";K.padM.style.background="url('"+jscolor.getDir()+"cross.gif') no-repeat";K.sld.style.overflow="hidden";K.sld.style.width=G+"px";K.sld.style.height=e+"px";K.sldB.style.position="absolute";K.sldB.style.right=B.pickerFace+"px";K.sldB.style.top=B.pickerFace+"px";K.sldB.style.border=B.pickerInset+"px solid";K.sldB.style.borderColor=B.pickerInsetColor;K.sldM.style.position="absolute";K.sldM.style.right="0";K.sldM.style.top="0";K.sldM.style.width=G+E+B.pickerFace+2*B.pickerInset+"px";K.sldM.style.height=K.box.style.height;K.sldM.style.background="url('"+jscolor.getDir()+"arrow.gif') no-repeat";try{K.sldM.style.cursor="pointer"}catch(H){K.sldM.style.cursor="hand"}t();u();jscolor.picker.owner=B;document.getElementsByTagName("body")[0].appendChild(K.boxB)}function t(){switch(n){case 0:var O=1;break;case 1:var O=2;break}var M=Math.round((B.hsv[0]/6)*(F-1));var N=Math.round((1-B.hsv[O])*(e-1));jscolor.picker.padM.style.backgroundPosition=(B.pickerFace+B.pickerInset+M-7)+"px "+(B.pickerFace+B.pickerInset+N-7)+"px";var L=jscolor.picker.sld.childNodes;switch(n){case 0:var J=h(B.hsv[0],B.hsv[1],1);for(var I=0;I<L.length;I++){L[I].style.backgroundColor="rgb("+(J[0]*(1-I/L.length)*100)+"%,"+(J[1]*(1-I/L.length)*100)+"%,"+(J[2]*(1-I/L.length)*100)+"%)"}break;case 1:var J,K,p=[B.hsv[2],0,0];var I=Math.floor(B.hsv[0]);var H=I%2?B.hsv[0]-I:1-(B.hsv[0]-I);switch(I){case 6:case 0:J=[0,1,2];break;case 1:J=[1,0,2];break;case 2:J=[2,0,1];break;case 3:J=[2,1,0];break;case 4:J=[1,2,0];break;case 5:J=[0,2,1];break}for(var I=0;I<L.length;I++){K=1-1/(L.length-1)*I;p[1]=p[0]*(1-K*H);p[2]=p[0]*(1-K);L[I].style.backgroundColor="rgb("+(p[J[0]]*100)+"%,"+(p[J[1]]*100)+"%,"+(p[J[2]]*100)+"%)"}break}}function u(){switch(n){case 0:var H=2;break;case 1:var H=1;break}var p=Math.round((1-B.hsv[H])*(e-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(B.pickerFace+B.pickerInset+p-5)+"px"}function i(){return jscolor.picker&&jscolor.picker.owner==B}function b(){if(D==A){B.importColor()}if(B.picker){B.hidePicker()}}function c(){if(D!=A){B.importColor()}}function x(p){var H=jscolor.getMousePos(p);var I=H[0]-q[0];var J=H[1]-q[1];switch(n){case 0:B.fromHSV(I*(6/(F-1)),1-J/(e-1),null,k);break;case 1:B.fromHSV(I*(6/(F-1)),null,1-J/(e-1),k);break}}function y(p){var H=jscolor.getMousePos(p);var I=H[1]-q[1];switch(n){case 0:B.fromHSV(null,null,1-I/(e-1),j);break;case 1:B.fromHSV(null,1-I/(e-1),null,j);break}}var B=this;var n=this.pickerMode.toLowerCase()=="hvs"?1:0;var a=false;var D=jscolor.fetchElement(this.valueElement),z=jscolor.fetchElement(this.styleElement);var f=false,g=false;var q,r;var G=16,E=7,F=181,e=101;var m=1<<0,l=1<<1,j=1<<2,k=1<<3;jscolor.addEvent(A,"focus",function(){if(B.picker){B.showPicker()}});jscolor.addEvent(A,"blur",function(){if(!a){setTimeout(function(){a||b();a=false},0)}else{a=false}});if(D){var C=function(){B.fromString(D.value,m)};jscolor.addEvent(D,"keyup",C);jscolor.addEvent(D,"input",C);jscolor.addEvent(D,"blur",c);D.setAttribute("autocomplete","off")}if(z){z.jscStyle={backgroundColor:z.style.backgroundColor,color:z.style.color}}this.importColor()}};jscolor.install();