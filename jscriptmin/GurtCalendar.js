var agC=[],ogB,oD;function gCalendar(b){var a=this;a.nCId=agC.length;agC[a.nCId]=a;if(!ogB){ogB=new _UserAgent()}if(!oD){oD=new _DManager()}a.sNameControl=b.dataArea?b.dataArea:"dataArea"+a.nCId;a.sIcoName="icoCls"+a.nCId;a.sPosName="icoPos"+a.nCId;a.sDivName="clsDiv"+a.nCId;a.sBoxName="clsBox"+a.nCId;a.sTitleName="clsTitle"+a.nCId;a.sPmiName="clsPMI"+a.nCId;a.sNmiName="clsNMI"+a.nCId;a.sPyiName="clsPYI"+a.nCId;a.sNyiName="clsNYI"+a.nCId;a.sPmaName="clsPMA"+a.nCId;a.sNmaName="clsNMA"+a.nCId;a.sPyaName="clsPYA"+a.nCId;a.sNyaName="clsNYA"+a.nCId;a.oChiefDate=new Date();a.sChiefFormat=!b.dateFormat?"m/d/Y":b.dateFormat;a.oApp=b.appearance;gBuildControl(a)}function gBuildControl(a){var b=new writer();b.into('<table cellpadding="0" cellspacing="0" border="0" ><tr><td><input type="Text" readonly id="',a.sNameControl,'"  name="',a.sNameControl,'" value=""  class ="',a.oApp.DataArea,'"></td><td align="right" width="25"><a href="javascript:gDisplayCalendar(agC['+a.nCId+']);" ><img src="',a.oApp.IcoCalVis,'" alt="" name="'+a.sIcoName+'" id="'+a.sIcoName+'" width="23" height="19" border="0"></a></td></tr><tr><td align="left" colspan="2"><img src="img/spacer.gif" alt="" name="'+a.sPosName+'" id="'+a.sPosName+'" width="1" height="1" border="0"></td></tr></table>');document.write(b.out());gBuildCalendar(a);gSetControl(a);gUpdateCalendarControl(a)}function gBuildCalendar(a){var b=new writer();b.into('<div  id="',a.sDivName,'"  name="',a.sDivName,'"  style="position: absolute; background-color:beige; visibility:hidden;  width:186; height:1; z-index: ',a.nCId+1,'"><table  width="100%" cellpadding="0" cellspacing="1" border="0" class="',a.oApp.OuterFrame,'"><tr><td ><table  width="100%" cellpadding="0" cellspacing="0" border="0" class="',a.oApp.InnerFrame,'"  ><tr><td  colspan="3" class="',a.oApp.TopPartNavpanel,'"><img src="img/spacer.gif" width="1 px" height="1 px"></td></tr><tr><td  width="100%"  colspan="3" class="',a.oApp.Navpanel,'"><table cellpadding="1" cellspacing="1" border="0" ><tr><td><a href="#" name="',a.sPyaName,'" id="',a.sPyaName,'"><img src="',a.oApp.PrevYear,'" alt="',a.oApp.messages["AltPrevYear"],'" name="',a.pyiName,'" id="',a.pyiName,'" width="18" height="21" border="0"></a></td><td><a href="#" name="',a.sPmaName,'" id="',a.sPmaName,'"><img src="',a.oApp.PrevMonth,'" alt="',a.oApp.messages["AltPrevMonth"],'" name="',a.sPmiName,'" id="',a.sPmiName,'" width="18" height="21" border="0"></a></td><td  width="100%" class="',a.oApp.InfoTitle,'" id="',a.sTitleName,'" name="',a.sTitleName,'">',a.oApp.longmonth[a.oChiefDate.getMonth()],"&nbsp;",a.oChiefDate.getFullYear(),'</td><td><a href="#" name="',a.sNmaName,'" id="',a.sNmaName,'"><img src="',a.oApp.NextMonth,'" alt="',a.oApp.messages["AltNextMonth"],'" name="',a.sNmiName,'" id="',a.sNmiName,'" width="18" height="21" border="0"></a></td><td><a href="#" name="',a.sNyaName,'" id="',a.sNyaName,'"><img src="',a.oApp.NextYear,'" alt="',a.oApp.messages["AltNextYear"],'" name="',a.sNyiName,'" id="',a.sNyiName,'" width="18" height="21" border="0"></a></td></tr></table></td></tr><tr><td colspan="3" class="',a.oApp.BottomPartNavpanel,'"><img src="img/spacer.gif" width="1 px" height="1 px"></td></tr><tr class="',a.oApp.MidRow,'"><td><img src="img/spacer.gif"  width="4 px"height="1 px"></td><td  align="center" id="',a.sBoxName,'" name="',a.sBoxName,'">',gUnitedGrid(a),'</td><td width="4 px"><img src="img/spacer.gif"  width="4 px" height="1 px"></td></tr><tr><td colspan="3" class="',a.oApp.BottomPartNavpanel,'"><img src="img/spacer.gif" width="1 px" height="1 px"></td></tr></table></td ></tr></table></div>');if(ogB.ie6){b.into('<iframe id="IE6bug',a.sDivName,'" src="img/spacer.gif"  name="IE6bug',a.sDivName,'" style="position: absolute; left:0; top:0; width:0; height:0; visibility:hidden; filter:alpha(opacity=0); z-index: ',a.nCId,'"></iframe>')}document.write(b.out())}function gDateReset(a){var b=a?new Date(a):new Date();b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0);return b}function gDateType(a,e){var b=1,f=new Date(e);f=gDateReset(f);var d=a.oChiefDate;if(gDateReset(d).valueOf()==f.valueOf()){b|=2}if(f.getMonth()!=d.getMonth()||f.getFullYear()!=d.getFullYear()){b|=8}if(f.getDay()==0||f.getDay()==6){b|=4}return b}function gDisplayCalendar(a){var b=String(a.oDiv.style.visibility).toLowerCase();if(b=="visible"||b=="show"){a.oDiv.style.visibility="hidden";if(ogB.ie6){a.oDiv2.style.visibility="hidden"}a.oIco.src=a.oApp.IcoCalVis}else{gRePosition(a);if(gVerifyDataArea(a)){gUpdateCalendarData(a)}a.oDiv.style.visibility="visible";if(ogB.ie6){a.oDiv2.style.width=a.oDiv.offsetWidth;a.oDiv2.style.height=a.oDiv.offsetHeight;a.oDiv2.style.visibility="visible"}a.oIco.src=a.oApp.IcoCalUnVis}}function gUserClickHandler(a,b,d){var c=b?new Date(b):new Date(a.oChiefDate);a.oChiefDate=new Date(c);if(!d){gDisplayCalendar(a);a.oDataArea.value=oD.GenerateDate(a.oChiefDate,a.sChiefFormat)}gUpdateCalendarData(a)}function gUpdateCalendarData(a){gUpdateCalendarControl(a);a.oInfoTitle.innerHTML=a.oApp.longmonth[a.oChiefDate.getMonth()]+"&nbsp;"+a.oChiefDate.getFullYear();a.oUnitedGrid.innerHTML="";a.oUnitedGrid.innerHTML=gUnitedGrid(a)}function gSetControl(a){var b;a.oDiv=gObja(a,a.sDivName);if(ogB.ie6){a.oDiv2=gObja(a,"IE6bug"+a.sDivName)}a.oIco=gObja(a,a.sIcoName);a.oPos=gObja(a,a.sPosName);a.oDataArea=gObja(a,a.sNameControl);a.oUnitedGrid=gObja(a,a.sBoxName);a.oInfoTitle=gObja(a,a.sTitleName);a.oPMI=gObja(a,a.sPmiName);a.oNMI=gObja(a,a.sNmiName);a.oPYI=gObja(a,a.pyiName);a.oNYI=gObja(a,a.sNyiName);a.oPMA=gObja(a,a.sPmaName);a.oNMA=gObja(a,a.sNmaName);a.oPYA=gObja(a,a.sPyaName);a.oNYA=gObja(a,a.sNyaName)}function gShiftDate(a,g,e,c,d,f){var b=new Date(a);if(g){b.setFullYear(b.getFullYear()+g)}if(e){b.setMonth(b.getMonth()+e)}if(c){b.setHours(b.getHours()+c)}if(d){b.setMinutes(b.getMinutes()+d)}if(f){b.setSeconds(b.getSeconds()+f)}if(!(c||d||f)){if(b.getDate()!=a.getDate()){b.setDate(0)}}return b.valueOf()}function gUpdateCalendarControl(a){a.oPYA.href="javascript:  gUserClickHandler(agC["+a.nCId+"],"+gShiftDate(a.oChiefDate,-1)+",2);";a.oNYA.href="javascript:  gUserClickHandler(agC["+a.nCId+"],"+gShiftDate(a.oChiefDate,1)+",2);";a.oPMA.href="javascript: gUserClickHandler(agC["+a.nCId+"],"+gShiftDate(a.oChiefDate,null,-1)+",1);";a.oNMA.href="javascript: gUserClickHandler(agC["+a.nCId+"],"+gShiftDate(a.oChiefDate,null,1)+",1);"}function gVerifyDataArea(a){if(a.oDataArea.value){oTmpDate=oD.ParseDate(a.oDataArea.value+"",a.sChiefFormat);if(!oTmpDate){alert(a.oApp.messages["Warning"]);oTmpDate=new Date()}if(oTmpDate.valueOf()!=a.oChiefDate.valueOf()){a.oChiefDate=new Date(oTmpDate);return true}else{a.oDataArea.value=oD.GenerateDate(a.oChiefDate,a.sChiefFormat);return false}}else{return false}}function gDayTitle(b){var c=new writer();c.into('<tr  class="',b.oApp.WeekDay,'">');for(var a=0;a<7;a++){c.into("<td>",b.oApp.weekdays[(a+1)%7],"</td>")}c.into("</tr>");return(c.out())}function gDayGrid(b){var f=new writer(),d=new Date(b.oChiefDate);d.setDate(1);d.setDate(1-(6+d.getDay())%7);var e=new Date(d);while(e.getMonth()==b.oChiefDate.getMonth()||e.getMonth()==d.getMonth()){f.into("<tr>");for(var c=0;c<7;c++){f.into(gDayCell(b,e));e.setDate(e.getDate()+1)}f.into("</tr>\n")}return(f.out())}function gUnitedGrid(a){var b=new writer();b.into('<table cellpadding="2"  cellspacing="1" border="0" width="100%"   class="',a.oApp.DateGrid,'">');b.into(gDayTitle(a));b.into(gDayGrid(a));b.into("</table>");return(b.out())}function _UserAgent(){var a=this,b=navigator.appName,e=a.version=navigator.appVersion,d=a.uas=navigator.userAgent.toLowerCase(),c=/opera/;a.op=c.exec(d)?true:false;a.ie=(b=="Microsoft Internet Explorer");if(a.op){a.ie=false}a.v=parseInt(e);if(a.ie){a.ie4=a.ie5=a.ie55=a.ie6=false;if(e.indexOf("MSIE 6")>0){a.ie6=true;a.v=6}}a.win32=d.indexOf("win")>-1;a.mac=d.indexOf("mac")>-1}function dmMakeWorkTemplate(inFormat){var _=this,sCh,nKey=0,aTmp=[],aDel=["\\\\","\\/","\\.","\\+","\\*","\\?","\\$","\\^","\\|"];for(nI=0;nI<inFormat.length;nI++){sCh=inFormat.substr(nI,1);if(_.dmFormatChar.indexOf(sCh)!=-1&&sCh!=""){aTmp[nKey]=sCh;_.dmTmpFormat[nKey++]=sCh}}nKey=1;for(nI in aDel){inFormat=inFormat.replace(eval("/"+aDel[nI]+"/g"),aDel[nI])}for(nI=0;nI<aTmp.length;nI++){re=new RegExp(aTmp[nI]);inFormat=inFormat.replace(re,_.dmRegFormatChar[aTmp[nI]])}return new RegExp("^"+inFormat.replace(/\s+/g,"\\s+")+"$")}function dmGenerateDate(c,d){var a=this,f,e=0,h="",g="",b=new Date(c);do{f=d.substr(e,1);if(a.dmFormatChar.indexOf(f)!=-1&&f!=""){if(typeof(b[a.dmCallChar[f][1]])!="function"){g=new String(a.dmCallChar[f][1](b))}else{g=new String(b[a.dmCallChar[f][1]]())}h+=g}else{h+=f}e++}while(e<d.length);return h}function dmParseDate(i,e){var a=this,b=[],f,g=1,m=a.MakeWorkTemplate(e),l=a.DateReset(),f,d=false,h=null,l=new Date(0,0,1),c,j=m.exec(i);if(!j||typeof(j)!="object"){return null}for(f in a.dmTmpFormat){b[f]=[j[g++],a.dmTmpFormat[f]]}oAdate=b;for(f in oAdate){if(a.dmSignFormatChar.indexOf(oAdate[f][1])!=-1){c=oAdate[f][1];var k=a.dmCallChar[oAdate[f][1]][2](oAdate[f][0]);if(c=="d"){chDate=c;h=k}l[a.dmCallChar[c][0]](k);if(h){l[a.dmCallChar[chDate][0]](h)}}}return l}function gDayCell(b,c){var d=new Date(c),a=gDateType(b,d),g,f,e;if(a&2){g="SelectedDay"}else{if(a&8){g="OtherMonthDay"}else{g="CurrentMonthDay"}}f="javascript: gUserClickHandler(agC["+b.nCId+"],"+c.valueOf()+");";e='<a href="'+f+'" class="'+b.oApp[g]+'">'+c.getDate()+"</a>";if(a&2){g="SelectedDay"}else{if(a&4){g="HoliDay"}else{if(a&8){g="OtherMonthDay"}else{g="WorkDay"}}}e='<td class="'+b.oApp[g+"Cell"]+'" align="center">'+e+"</td>";return e}function _DManager(){var a=this;a.dmFormatChar="dmY";a.dmSignFormatChar="dmY";a.dmRegFormatChar={d:"([0-9]{0,2})",m:"([0-9]{0,2})",Y:"([0-9]{4})"};a.dmCallChar={d:["setDate",function(c,b){c=c.getDate();if(c<10){return("0"+c)}else{return c}},function(b){return b*1}],m:["setMonth",function(b){b=b.getMonth()+1;if(b<10){return("0"+b)}else{return b}},function(b){return(b*1-1)}],Y:["setFullYear","getFullYear",function(b){return b*1}]};a.dmTmpFormat=[];a.DateReset=gDateReset;a.MakeWorkTemplate=dmMakeWorkTemplate;a.GenerateDate=dmGenerateDate;a.ParseDate=dmParseDate}function gRePosition(a){a.oDiv.style.left=gGlobalPosition(a,"Left")+"px";a.oDiv.style.top=gGlobalPosition(a,"Top")+"px";if(ogB.ie6){a.oDiv2.style.left=a.oDiv.style.left;a.oDiv2.style.top=a.oDiv.style.top}}function gGlobalPosition(a,b){var c=0,d=a.oPos;while(d){c+=d["offset"+b];d=d.offsetParent}return c}function gObja(a,b){if(document.images&&document.images[b]){return document.images[b]}else{if(a.formName&&document.forms[a.formName].elements[b]){return document.forms[a.formName].elements[b]}else{if(document.all&&document.all[b]){return document.all[b]}else{if(document.getElementById){return document.getElementById(b)}else{return null}}}}}function writer(){var a=this;a.bufArray=[];a.into=function(){var b=arguments.length;for(var c=0;c<b;c++){a.bufArray[a.bufArray.length]=arguments[c]}};a.out=function(){return a.bufArray.join("")}};