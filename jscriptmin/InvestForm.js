var errorDivs;function saveFilesExt(){var a=$("riFilePathExt").value;if(!checkFileExt(a)){return false}if($("riFileExtDesc").value==""){alert("File Description Required.");$("riFileExtDesc").focus();return false}fileUpload(document.frmInvestigate,"riSaveFile.asp?ua=reportext&incid="+document.frmInvestigate.incidentId.value,"uploadedFileExt");$("riFileExtDesc").value="";$("dvRiFilePathExt").innerHTML='<input type="file" name="riFilePathExt" id="riFilePathExt" />'}function deleteExtFile(a,b){if(confirm("Do you really want to delete this file?")){new Ajax.Request("ReportIncident.asp?Ajax=1&doAction=delFiles&fileId="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(f){hideObject(b);var e=$(b).parentNode.parentNode;var d=e.rows.length;var g=false;for(i=0;i<d;i++){if(e.rows[i].style.visibility==""){g=true;break}}if(!g){e.style.display="none"}}})}}function enableBox(a){if(a.value=="Please enter a root cause"){a.style.color="#000000";a.value=""}}function disableBox(a){if(a.value==""){a.style.color="#FF0000";a.value="Please enter a root cause"}}function changeDisplay(a,b){if($(a)!=null){if(b=="show"){$(a).style.display=""}else{$(a).style.display=b}}}function checkNotify(a){var b=a.value;if(b=="other"){$("specifyDetail").style.display=""}else{$("specifyDetail").style.display="none"}}function checkDetails(a){var b=a.value;if(b=="Put Details"){a.value=""}}function addHOC(a,b){$(a+"layer").style.display="";$(a).value=b.value}function toggleHOC(a,b){$(a+"layer").style.display=b}function toggleExt(a){$("extDetails").style.display=a;if($("extDocuments")!=null){$("extDocuments").style.display=a}if($("extFileUpload")!=null){$("extFileUpload").style.display=a}}function saveQuest(e){var d=true;var f=1;var b;var a="&incid="+document.frmInvestigate.incidentId.value;for(i=0;i<e.length;i++){a+="&q"+e[i]+"=";b=document.getElementsByName("q"+e[i]);for(j=0;j<b.length;j++){if(b[j].checked){a+=b[j].value}}}new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveQuest&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(g){moveSection("stepRiskAssessmentSub","stepRootCauseSub")}})}function saveInvestigateDetails(a){if($("txtInvestigateDetails").value!=""){var b="incid="+document.frmInvestigate.incidentId.value;b+="&details="+encodeURIComponent($("txtInvestigateDetails").value);$("divInvestigationFindings").innerHTML="<img src='images/ajax-loader.gif' alt='Loading' /><br />Updating...";new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveDetails&pseudoParam="+new Date().getTime(),{method:"POST",parameters:b,onSuccess:function(d){$("txtInvestigateDetails").value="";$("divInvestigationFindings").innerHTML=d.responseText;if(a!="noMove"){moveSection("stepIncidentDetailsSub","stepInterviewSub")}}})}else{if(a!="noMove"){moveSection("stepIncidentDetailsSub","stepInterviewSub")}}}function saveFiles(a){if($("riFileDesc").value==""){alert("File Description Required");$("riFileDesc").focus();return false}if(!checkFileExt($("riFilePath").value)){return false}fileUpload(document.frmInvestigate,"riSaveFile.asp?ua="+a+"&incid="+document.frmInvestigate.incidentId.value,"uploadedFile");$("riFileDesc").value="";$("dvRiFilePath").innerHTML='<input type="file" name="riFilePath" id="riFilePath" />'}function deleteFile(a,b){if(confirm("You are about to delete this file. Do you wish to continue?")){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=delRIFiles&fileId="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(f){hideObject(b);var e=$(b).parentNode.parentNode;var d=e.rows.length;var g=false;for(i=0;i<d;i++){if(e.rows[i].style.visibility==""){g=true;break}}if(!g){e.style.display="none"}}})}}function addInerviews(){var a="incid="+document.frmInvestigate.incidentId.value;a+="&pinterview="+$("interview").value;a+="&irecorded="+($RF("interviewRecorded")==null)?"":$RF("interviewRecorded");a+="&iDesc="+$("interviewDesc").value;if($("interview").selectedIndex!=0){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveInterview&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(b){loadInterviews();$("interview").selectedIndex=0;$("jobTitle").value="";$("interviewDesc").value="";hideObject("tblInterview");showObject("trAddInterview")}})}}function loadInterviews(){new Ajax.Request("InvestForm.asp?Ajax=1&loadIntv=1&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("interviewList").innerHTML=a.responseText;if(a.responseText==""){showObject("tblInterview");hideObject("trAddInterview")}}})}function loadInvestigationTeam(){new Ajax.Request("InvestForm.asp?Ajax=1&loadInvTeam=1&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("investigationTeamList").innerHTML=a.responseText}})}function loadSteppedCauseAnswers(){new Ajax.Request("InvestForm.asp?Ajax=1&loadSCAnswers=1&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("steppedCauseAnswers").innerHTML=a.responseText}})}function deleteInterView(a){if(confirm("Do you want delete this Interview Record?")){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=delInterview&iid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(b){loadInterviews()}})}}function SaveExtDoc(a,b){if(!b){if($("dboDocSelect").value==0&&$("ExtDocUpload").value!=""){alert("Please select the document you are uploading");return false}if($("ExtDocUpload").value==""&&$("dboDocSelect").value!=0){alert("Please click browse and select the file to upload");return false}}else{if($("ExtDocUpload").value!=""&&$("dboDocSelect").value==0){alert("Please select the document you are uploading");return false}if($("ExtDocUpload").value==""&&$("dboDocSelect").value!=0){return false}}if($("ExtDocUpload").value!=""&&$("dboDocSelect").value!=0){if(!checkFileExt($("ExtDocUpload").value)){return false}fileUpload(document.frmInvestigate,"UploadExtDocumentSubmit.asp?docId="+$("dboDocSelect").value+"&ua="+a+"&incid="+document.frmInvestigate.incidentId.value,"extDocUploader","loadExtDocuments")}}function loadExtDocList(){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=GetExtDocDDL&incidentId="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("ExtDocsSub").innerHTML=a.responseText}})}function loadExtDocuments(){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=GetExtDocuments&incidentId="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("extDocumentsReq").innerHTML=a.responseText;loadExtDocList()}})}function uploadInterViewFile(a){if($("riFileDescInterview").value==""){alert("File Description Required");$("riFileDescInterview").focus();return false}if(!checkFileExt($("riFilePathInterview").value)){return false}fileUpload(document.frmInvestigate,"riSaveFileInterview.asp?ua="+a+"&incid="+document.frmInvestigate.incidentId.value,"uploadedInterviewFile");$("riFileDescInterview").value="";$("dvFilePathInterview").innerHTML='<input type="file" name="riFilePathInterview" id="riFilePathInterview"/>'}function loadMatrix(){new Ajax.Request("CreateRiskMatrix.asp?incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("riskMatrix").innerHTML=a.responseText}})}function saveLikelihood(b){var a="incid="+document.frmInvestigate.incidentId.value;a+="&llh="+b;new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveLikeLihood&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(d){loadMatrix();changeRiskLevel()}})}function saveSeverity(b){var a="incid="+document.frmInvestigate.incidentId.value;a+="&svr="+b;new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveSeverity&pseudoParam="+new Date().getTime(),{method:"POST",parameters:a,onSuccess:function(d){loadMatrix();changeRiskLevel()}})}function changeRiskLevelOnClick(e,a){var b=document.forms["frmInvestigate"]["SeverityId"];var d=document.forms["frmInvestigate"]["LiklihoodId"];for(i=0;i<b.length;i++){if(b[i].value==e){b[i].checked=true;saveSeverity(e)}}for(i=0;i<d.length;i++){if(d[i].value==e){d[i].checked=true;saveLikelihood(a)}}return;changeRiskLevel()}function changeRiskLevel(){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=getRiskLevel&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){if(a.responseText!=""){$("levelOfRisk").innerHTML="Risk Level: "+a.responseText}}})}function loadDistributorInfo(a){new Ajax.Request("ReportIncident.asp?Ajax=1&iid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(f){if(f.responseText!=""){var d=f.responseXML;try{$("distLocation").value=d.getElementsByTagName("location")[0].childNodes[0].nodeValue}catch(b){$("distLocation").value=""}try{$("distJobTitle").value=d.getElementsByTagName("jobTitle")[0].childNodes[0].nodeValue}catch(b){$("distJobTitle").value=""}}}})}function loadIntervieweeInfo(a){new Ajax.Request("ReportIncident.asp?Ajax=1&iid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(f){if(f.responseText!=""){var d=f.responseXML;try{$("jobTitle").innerHTML=d.getElementsByTagName("jobTitle")[0].childNodes[0].nodeValue}catch(b){$("jobTitle").innerHTML=""}}}})}function loadDistributionList(){new Ajax.Request("InvestForm.asp?Ajax=1&loadDist=1&incid="+document.frmInvestigate.incidentId.value+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(a){$("distributionList").innerHTML=a.responseText}})}function saveDistributionList(){var a="&incid="+document.frmInvestigate.incidentId.value;a+="&distid="+$("distId").value;a+="&distJobTitle="+escape($("distJobTitle").value);a+="&distRegion="+escape($("distLocation").value);new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveDist"+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(b){loadDistributionList();hideObject("tblDist");showObject("tblAddDist")}})}function removeDistribution(b){if(confirm("This will remove the person from the incident. Do you want to continue?")){var a=document.frmInvestigate.incidentId.value;new Ajax.Request("InvestForm.asp?Ajax=1&doAction=removeDist&incid="+a+"&distid="+b+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(d){loadDistributionList()}})}}function saveExternalNotifier(e){var f="&incid="+document.frmInvestigate.incidentId.value;f+="&reqEN="+$RF("externalNotifer");var b=document.getElementsByName("chkExternalNotifer");var a=document.getElementsByName("rdCompensation");var d=document.getElementsByName("rdRRTWC");var h="";var g="";var k="";for(i=0;i<b.length;i++){if(b[i].checked){h+=b[i].value+";"}}for(i=0;i<a.length;i++){if(a[i].checked){g+=a[i].value}}for(i=0;i<d.length;i++){if(d[i].checked){k+=d[i].value}}f+="&valEN="+h;f+="&valComp="+g;f+="&valRRTWC="+k;f+="&enOth="+escape($("specifyDetail").value);new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveEN&pseudoParam="+new Date().getTime(),{method:"POST",parameters:f,onSuccess:function(l){if(e!="noMove"){moveSection("stepExternalSub",l.responseText)}}})}function saveRootCause(e){var f="incid="+document.frmInvestigate.incidentId.value;var d=$("rootCauseIds").value.split(";");var g="";var b="";var a="";for(i=0;i<d.length-1;i++){if($RF("rootMS_"+d[i])=="Yes"){a="";f+="&causeDesc_"+d[i]+"="+escape($("causeDesc_"+d[i]).value);cfs=document.getElementsByName("cfChk_"+d[i]);for(j=0;j<cfs.length;j++){if(cfs[j].checked){a+=cfs[j].value+";"}}f+="&causeCF_"+d[i]+"="+a;g+=d[i]+";"}else{if($RF("rootMS_"+d[i])=="No"){b+=d[i]+";"}}}f+="&rtIds="+g;f+="&delRTids="+b;new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveRC&pseudoParam="+new Date().getTime(),{method:"POST",parameters:f,onSuccess:function(h){if(h.responseText!=""){alert(h.responseText)}loadCorrectiveActionsRows(e)}})}function loadCorrectiveActionsRows(a,e,d){var b=document.getElementById("heirarchySecNum").innerHTML;new Ajax.Request("InvestForm.asp?Ajax=1&loadCA=1&incid="+document.frmInvestigate.incidentId.value+"&secNum="+b+"&pseudoParam="+new Date().getTime(),{method:"GET",onSuccess:function(h){$("caList").innerHTML=h.responseText;if(a==null){moveSection("stepRootCauseSub","stepHierachySub")}try{if(a.toUpperCase()!="NOMOVE"){moveSection("stepRootCauseSub","stepHierachySub")}}catch(g){}if(a=="moveToDist"){moveSection("stepHierachySub","stepDistributionListSub")}if(e!=""){try{var f=$(e);setDDLValue(f,d)}catch(g){}}}})}function saveCorrectiveActions(a,b){if($("txtCaDetails_"+a).value==""){alert("Please enter a corrective action.");$("txtCaDetails_"+a).focus();return false}if($("hdExecutorCount_"+a).value=="0"){alert("You must add at least one executor to the Corrective Action.");return false}if($("caWhen_"+a).value==""){alert("'By When' field must have a date value.");$("caWhen_"+a).focus();return false}var d="incid="+document.frmInvestigate.incidentId.value;d+="&ircid="+a;d+="&details="+escape($("txtCaDetails_"+a).value);d+="&multiExecutors=1&caTakenBy="+$("caExecutors_"+a).value.replace(/,$/,"");d+="&caWhen="+$("caWhen_"+a).value;d+="&caStatus="+$("caStatus_"+a).value;new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveRCA&pseudoParam="+new Date().getTime(),{method:"POST",parameters:d,onSuccess:function(e){loadCorrectiveActionsRows("nomove");$("txtCaDetails_"+a).value="";$("caWhen_"+a).value="";$("caStatus_"+a).selectedIndex=0;$("hdExecutorCount_"+a).value="0";$("caExecutors_"+a).value="";$("caExecutorsDiv_"+a).innerHTML=""}})}function saveCorrectiveActionsCheckList(b,a,d){if($("txtCaDetails_"+b+"_"+a).value==""){alert("Please enter a corrective action.");$("txtCaDetails_"+b+"_"+a).focus();return false}if($("hdExecutorCount_"+b+"_"+a).value=="0"){alert("'You must add at least one executor to the Corrective Action.");return false}if($("caWhen_"+b+"_"+a).value==""){alert("'By When' field must have a date value.");$("caWhen_"+b+"_"+a).focus();return false}var e="incid="+document.frmInvestigate.incidentId.value;e+="&ircid="+b;e+="&chkListId="+a;e+="&details="+escape($("txtCaDetails_"+b+"_"+a).value);e+="&multiExecutors=1&caTakenBy="+$("caExecutors_"+b+"_"+a).value.replace(/,$/,"");e+="&caWhen="+$("caWhen_"+b+"_"+a).value;e+="&caStatus="+$("caStatus_"+b+"_"+a).value;new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveRCA&pseudoParam="+new Date().getTime(),{method:"POST",parameters:e,onSuccess:function(f){loadCorrectiveActionsCheckList(b,a);$("txtCaDetails_"+b+"_"+a).value="";$("caWhen_"+b+"_"+a).value="";$("caStatus_"+b+"_"+a).selectedIndex=0;$("hdExecutorCount_"+b+"_"+a).value="0";$("caExecutors_"+b+"_"+a).value="";$("caExecutorsDiv_"+b+"_"+a).innerHTML=""}})}function loadCorrectiveActionsCheckList(b,a){new Ajax.Request("InvestForm.asp?Ajax=1&loadCAList=1&ircid="+b+"&chkListId="+a+"&pseudoParam="+new Date().getTime(),{method:"GET",onSuccess:function(d){$("rcaList_"+b+"_"+a).innerHTML=d.responseText}})}function loadCorrectiveActions(a){new Ajax.Request("InvestForm.asp?Ajax=1&loadCAList=1&ircid="+a+"&pseudoParam="+new Date().getTime(),{method:"GET",onSuccess:function(b){$("rcaList_"+a).innerHTML=b.responseText}})}function addNewDistributor(){var a=document.frmInvestigate.incidentId.value;myLightWindow.activateWindow({href:"AddPerson.asp?addAs=INVDIST&incid="+a,title:"Add New Person",type:"external",width:440,height:550})}function editCorrectiveAction(a,b){myLightWindow.activateWindow({href:"editCA.asp?caid="+a+"&ircid="+b,title:"Edit Corrective Action",type:"external",width:550,height:450})}function deleteCorrectiveAction(a,d,b){if(confirm("You are about to delete this corrective action. Do you wish to continue?")){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=delCA&caid="+a+"&pseudoParam="+new Date().getTime(),{method:"GET",onSuccess:function(e){loadCorrectiveActionsCheckList(d,b)}})}}function finish(a){var b=document.getElementsByName("incidentRootCauseId");for(i=0;i<b.length;i++){if($("txtCaDetails_"+b[i].value).value!=""){alert("Please click on 'Save' to save the Corrective Action.");$("txtCaDetails_"+b[i].value).focus();return}}showProcess("Verifying Data. Please wait...");clearErrorMsg();setTimeout("addInerviews()",500);setTimeout('saveInvestigateDetails("noMove")',1000);if(document.getElementById("stepExternalTitle")!=null){setTimeout('saveExternalNotifier("noMove")',1500)}setTimeout('saveRootCause("noMove")',2000);setTimeout('saveAllCorrectiveAction("noMove",\''+a+"')",2500);setTimeout("checkData()",3000)}function doSave(a){showProcess("Verifying Data. Please wait...");clearErrorMsg();setTimeout("addInerviews()",500);setTimeout('saveInvestigateDetails("noMove")',1000);setTimeout('saveExternalNotifier("noMove")',1500);setTimeout('saveRootCause("noMove")',2000);setTimeout('saveAllCorrectiveAction("noMove",\''+a+"')",2500);setTimeout("checkData()",3000);alert("Investigation details have been saved and await approval.");document.location="investigationslistAll.asp?m=1&s=24"}function checkData(){var a=document.frmInvestigate.incidentId.value;new Ajax.Request("InvestForm.asp?Ajax=1&checkForm=1&incid="+a+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(k){var l=k.responseXML;var b=l.getElementsByTagName("ERROR");var h=false;errorDivs=new Array();var d=false;for(i=0;i<b.length;i++){var g=b[i];errorDivs.push(new Array(g.childNodes[1].childNodes[0].nodeValue,$(g.childNodes[2].childNodes[0].nodeValue).style.display));$(g.childNodes[1].childNodes[0].nodeValue).style.display="";$(g.childNodes[2].childNodes[0].nodeValue).style.display="";$(g.childNodes[2].childNodes[0].nodeValue).innerHTML+=g.childNodes[3].childNodes[0].nodeValue+"<br/>";h=true;if(!d){document.location="#"+g.childNodes[1].childNodes[0].nodeValue;d=true}if((g.childNodes[2].childNodes[0].nodeValue).match("errorMsgstep7sub")){$("stepHierachySub").style.display=""}}$("dvProgress").style.display="none";if(h){alert("Please fill in the following information marked red")}if(!h){if(confirm("You are about to finish this investigation. Click OK to confirm or cancel to make changes")){try{if($("incidentId").value!=""){ir_delExpandedId($("incidentId").value+"_tabstate","stepDistributionListSub")}}catch(f){}document.frmInvestigate.action="InvestFinishEmail.asp";document.frmInvestigate.submit()}}},onFailure:function(b){alert("An error occured while trying to check the data. Please click on Review again. \n(If this message continues to appear contact Rapid Induct");$("dvReview").style.display="none"}})}function clearErrorMsg(){var a=document.getElementsByTagName("DIV");for(i=0;i<a.length;i++){var b=a[i].getAttribute("id");if(b!=null){if(b.indexOf("errorMsg")>-1){$(b).innerHTML="";$(b).style.display=""}}}if(errorDivs!=null){for(i=0;i<errorDivs.length;i++){var d=errorDivs[i];$(d[0]).style.display=d[1]}}}function setInnerHTML(d,b){try{$(d).innerHTML=b.value}catch(a){}}function saveAllCorrectiveAction(d,a){var b=document.getElementsByName("incidentRootCauseId");var e="incid="+document.frmInvestigate.incidentId.value;e+="&ircCount="+b.length;var f=false;for(i=0;i<b.length;i++){if(a){if($("rdoNo_"+b[i].value)!=null){if($("rdoNo_"+b[i].value).checked){$("txtCaDetails_"+b[i].value).value=""}}}if($("txtCaDetails_"+b[i].value).value!=""){if($("caWhen_"+b[i].value).value==""){alert("'By When' field must have a date value.");$("caWhen_"+b[i].value).focus();return false}if($("hdExecutorCount_"+b[i].value).value=="0"){alert("'You must add at least one executor to the Corrective Action.");$("caTakenBy_"+b[i].value).focus();return false}e+="&ircid_"+i+"="+b[i].value.replace(/_[0-9]+$/,"");e+="&details_"+i+"="+escape($("txtCaDetails_"+b[i].value).value);e+="&multiExecutors_"+i+"=1&caTakenBy_"+i+"="+$("caExecutors_"+b[i].value).value.replace(/,$/,"");if(a){e+="&cachkId_"+i+"="+$("incidentCheckListId_"+b[i].value).value}e+="&caWhen_"+i+"="+$("caWhen_"+b[i].value).value;e+="&caStatus_"+i+"="+$("caStatus_"+b[i].value).value;f=true}if(a){if($("rdoNo_"+b[i].value).checked){if($("ReasonNo_"+b[i].value).value!=""){e+="&ircid_"+i+"="+b[i].value.replace(/_[0-9]+$/,"");e+="&cachkId_"+i+"="+$("incidentCheckListId_"+b[i].value).value;e+="&reasonNo_"+i+"="+$("ReasonNo_"+b[i].value).value;f=true}}}}if(d==null){d="moveToDist"}if(f){new Ajax.Request("InvestForm.asp?Ajax=1&doAction=saveAllRCA&pseudoParam="+new Date().getTime(),{method:"POST",parameters:e,onSuccess:function(g){loadCorrectiveActionsRows(d)}})}else{loadCorrectiveActionsRows(d)}}function addNewPersonInterview(){var a=document.frmInvestigate.incidentId.value;myLightWindow.activateWindow({href:"AddPerson.asp?addAs=INTV&incid="+a,title:"Add New Person",type:"external",width:440,height:550})}function addNewPersonCA(b){var a=document.frmInvestigate.incidentId.value;myLightWindow.activateWindow({href:"AddPerson.asp?selName="+b+"&addAs=INVCA&incid="+a,title:"Add New Person",type:"external",width:440,height:550})}function loadPersonDDL(e,a,f,b){var d=$(f).onlick;var g=$(f).style;new Ajax.Request("ReportIncident.asp?Ajax=1&personSelId="+e+"&selName="+f+"&pseudoParam="+new Date().getTime(),{method:"get",onSuccess:function(h){$(a).innerHTML=h.responseText;if(f=="interview"){$("jobTitle").value=b;$(f).onclick=function(){loadIntervieweeInfo(this.value)};$(f).style=g}}})}function editInvestigator(){var a=document.frmInvestigate.incidentId.value;myLightWindow.activateWindow({href:"InvestigationsAssign.asp?displaymode=bodyonly&incidentId="+a,title:"Edit Investigation Team",type:"external",width:691,height:420})}function removeMSWordChars(e){var d=new Array();var b,a;d[8216]=39;d[8217]=39;d[8220]=34;d[8221]=34;d[8212]=45;for(c=0;c<e.length;c++){var b=e.charCodeAt(c);if(d[b]!=undefined){a=d[b];e=e.substr(0,c)+String.fromCharCode(a)+e.substr(c+1)}}return e}function hideCA(b){var a=document.getElementById("chkYes_"+b);a.style.visibility="hidden";a.style.display="none";var a=document.getElementById("chkNo_"+b);a.style.visibility="visible";a.style.display=""}function showCA(b){var a=document.getElementById("chkYes_"+b);a.style.visibility="visible";a.style.display="";var a=document.getElementById("chkNo_"+b);a.style.visibility="hidden";a.style.display="none"}function setCAExecutor(f,h,k){var b=document.getElementById("caExecutorsDiv_"+f);var d=document.getElementById("caExecutors_"+f);var a=document.getElementById("hdExecutorCount_"+f);b.innerHTML="";d.value="";a.value=0;var g=h.split(",");var l=k.split(",");for(var e=0;e<g.length;e++){b.innerHTML+="<span id='"+f+":"+g[e]+"'><a href='#' onclick=\"removeCAExecutor('"+f+"','"+g[e]+"');return false\"><img src='images/delete2_16x16.gif' title='Remove Executor' alt='Remove Executor' style='border-style: none;'></a> "+l[e]+"<br /></span>";a.value++}d.value=h;myLightWindow.deactivate()}function addCAExecutor(f){var b=document.getElementById("caExecutorsDiv_"+f);var d=document.getElementById("caTakenBy_"+f);var e=document.getElementById("caExecutors_"+f);if(d.selectedIndex==0){alert("You must select a person to add");return false}var g=d.value;var h=d.options[d.selectedIndex].text;d.selectedIndex=0;if(e.value.indexOf(g+",")!=-1){return false}var a=document.getElementById("hdExecutorCount_"+f);a.value++;e.value+=g+",";b.innerHTML+="<span id='"+f+":"+g+"'><a href='#' onclick=\"removeCAExecutor('"+f+"','"+g+"');return false\"><img src='images/delete2_16x16.gif' title='Remove Executor' alt='Remove Executor' style='border-style: none;'></a> "+h+"<br /></span>"}function removeCAExecutor(e,g){var b=document.getElementById("caExecutorsDiv_"+e);var d=document.getElementById("caExecutors_"+e);var f=document.getElementById(e+":"+g);b.removeChild(f);d.value=d.value.replace(g+",","");var a=document.getElementById("hdExecutorCount_"+e);a.value--}function resetAdd(a,b){$("txtCaDetails_"+a).value="";$("caTakenBy_"+a).selectedIndex=0;$("caWhen_"+a).value="";$("caStatus_"+a).selectedIndex=0;$("hdExecutorCount_"+a).value="0";if(b){$("caExecutors_"+a).value="";$("caExecutorsDiv_"+a).innerHTML=""}}function AddPeopleToCA(d){var e=document.frmInvestigate.incidentId.value;var b=document.getElementById("caExecutors_"+d);var a="";if(b.value!=""){a="&selPeople="+b.value.replace(/,$/,"")}var f="AddPersonCA.asp?id="+d+"&incid="+e+a;myLightWindow.activateWindow({href:f,title:"Add Executors to Corrective Action",type:"external",width:440,height:550})}function checkCAData(g,f,e){var a=document.getElementsByName("checkListId_"+g);for(var b=0;b<a.length;b++){var d=g+"_"+a[b].value;if($("rdoYes_"+d).checked){if($("txtCaDetails_"+d).value!=""){if($("caWhen_"+d).value==""){alert("'By When' field must have a date value.");$("caWhen_"+d).focus();return false}if($("hdExecutorCount_"+d).value=="0"){alert("'You must add at least one executor to the Corrective Action.");$("caTakenBy_"+d).focus();return false}}}}moveSection(f,e)};