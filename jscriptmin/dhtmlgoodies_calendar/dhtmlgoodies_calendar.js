var turnOffYearSpan=false;var weekStartsOnSunday=false;var showWeekNumber=true;var languageCode="en";var calendar_display_time=true;var todayStringFormat="[todayString] [UCFdayString]. [day]. [monthString] [year]";var pathToImages="JScript/images/";var speedOfSelectBoxSliding=200;var intervalSelectBox_minutes=5;var calendar_offsetTop=0;var calendar_offsetLeft=0;var calendarDiv=false;var MSIE=false;var Opera=false;if(navigator.userAgent.indexOf("MSIE")>=0&&navigator.userAgent.indexOf("Opera")<0){MSIE=true}if(navigator.userAgent.indexOf("Opera")>=0){Opera=true}switch(languageCode){case"en":var monthArray=["January","February","March","April","May","June","July","August","September","October","November","December"];var monthArrayShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var dayArray=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];var weekString="Week";var todayString="";break;case"ge":var monthArray=["Januar","Februar","M?rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];var monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"];var dayArray=["Mon","Die","Mit","Don","Fre","Sam","Son"];var weekString="Woche";var todayString="Heute";break;case"no":var monthArray=["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"];var monthArrayShort=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"];var dayArray=["Man","Tir","Ons","Tor","Fre","L&oslash;r","S&oslash;n"];var weekString="Uke";var todayString="Dagen i dag er";break;case"nl":var monthArray=["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"];var monthArrayShort=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"];var dayArray=["Ma","Di","Wo","Do","Vr","Za","Zo"];var weekString="Week";var todayString="Vandaag";break;case"es":var monthArray=["Enero","Febrero","Marzo","April","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];var monthArrayShort=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];var dayArray=["Lun","Mar","Mie","Jue","Vie","Sab","Dom"];var weekString="Semana";var todayString="Hoy es";break;case"pt-br":var monthArray=["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];var monthArrayShort=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];var dayArray=["Seg","Ter","Qua","Qui","Sex","S&aacute;b","Dom"];var weekString="Sem.";var todayString="Hoje &eacute;";break;case"fr":var monthArray=["Janvier","F?vrier","Mars","Avril","Mai","Juin","Juillet","Ao?t","Septembre","Octobre","Novembre","D?cembre"];var monthArrayShort=["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Aou","Sep","Oct","Nov","Dec"];var dayArray=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];var weekString="Sem";var todayString="Aujourd'hui";break;case"da":var monthArray=["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"];var monthArrayShort=["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"];var dayArray=["man","tirs","ons","tors","fre","l&oslash;r","s&oslash;n"];var weekString="Uge";var todayString="I dag er den";break;case"hu":var monthArray=["Január","Február","Március","??prilis","Május","Június","Július","Augusztus","Szeptember","Október","November","December"];var monthArrayShort=["Jan","Feb","Márc","??pr","Máj","Jún","Júl","Aug","Szep","Okt","Nov","Dec"];var dayArray=["Hé","Ke","Sze","Cs","Pé","Szo","Vas"];var weekString="Hét";var todayString="Mai nap";break;case"it":var monthArray=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];var monthArrayShort=["Gen","Feb","Mar","Apr","Mag","Giu","Lugl","Ago","Set","Ott","Nov","Dic"];var dayArray=["Lun",";Mar","Mer","Gio","Ven","Sab","Dom"];var weekString="Settimana";var todayString="Oggi &egrave; il";break;case"sv":var monthArray=["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"];var monthArrayShort=["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"];var dayArray=["M&aring;n","Tis","Ons","Tor","Fre","L&ouml;r","S&ouml;n"];var weekString="Vecka";var todayString="Idag &auml;r det den";break;case"cz":var monthArray=["leden","&#250;nor","b&#345;ezen","duben","kv&#283;ten","&#269;erven","&#269;ervenec","srpen","z&#225;&#345;&#237;","&#345;&#237;jen","listopad","prosinec"];var monthArrayShort=["led","&#250;n","b&#345;","dub","kv&#283;","&#269;er","&#269;er-ec","srp","z&#225;&#345;","&#345;&#237;j","list","pros"];var dayArray=["Pon","&#218;t","St","&#268;t","P&#225;","So","Ne"];var weekString="t&#253;den";var todayString="";break}if(weekStartsOnSunday){var tempDayName=dayArray[6];for(var theIx=6;theIx>0;theIx--){dayArray[theIx]=dayArray[theIx-1]}dayArray[0]=tempDayName}var daysInMonthArray=[31,28,31,30,31,30,31,31,30,31,30,31];var currentMonth;var currentYear;var currentHour;var currentMinute;var calendarContentDiv;var returnDateTo;var returnFormat;var activeSelectBoxMonth;var activeSelectBoxYear;var activeSelectBoxHour;var activeSelectBoxMinute;var iframeObj=false;var iframeObj2=false;function EIS_FIX_EI1(b){if(!iframeObj2){return}iframeObj2.style.display="block";iframeObj2.style.height=document.getElementById(b).offsetHeight+1;iframeObj2.style.width=document.getElementById(b).offsetWidth;iframeObj2.style.left=getleftPos(document.getElementById(b))+1-calendar_offsetLeft;iframeObj2.style.top=getTopPos(document.getElementById(b))-document.getElementById(b).offsetHeight-calendar_offsetTop}function EIS_Hide_Frame(){if(iframeObj2){iframeObj2.style.display="none"}}var returnDateToYear;var returnDateToMonth;var returnDateToDay;var returnDateToHour;var returnDateToMinute;var inputYear;var inputMonth;var inputDay;var inputHour;var inputMinute;var calendarDisplayTime=false;var selectBoxHighlightColor="#D60808";var selectBoxRolloverBgColor="#E2EBED";var selectBoxMovementInProgress=false;var activeSelectBox=false;function cancelCalendarEvent(){return false}function isLeapYear(b){if(b%400==0||(b%4==0&&b%100!=0)){return true}return false}var activeSelectBoxMonth=false;var activeSelectBoxDirection=false;function highlightMonthYear(){if(activeSelectBoxMonth){activeSelectBoxMonth.className=""}activeSelectBox=this;if(this.className=="monthYearActive"){this.className=""}else{this.className="monthYearActive";activeSelectBoxMonth=this}if(this.innerHTML.indexOf("-")>=0||this.innerHTML.indexOf("+")>=0){if(this.className=="monthYearActive"){selectBoxMovementInProgress=true}else{selectBoxMovementInProgress=false}if(this.innerHTML.indexOf("-")>=0){activeSelectBoxDirection=-1}else{activeSelectBoxDirection=1}}else{selectBoxMovementInProgress=false}}function showMonthDropDown(){if(document.getElementById("monthDropDown").style.display=="block"){document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("monthDropDown").style.display="block";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("monthDropDown")}}}function showYearDropDown(){if(document.getElementById("yearDropDown").style.display=="block"){document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("yearDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("yearDropDown")}}}function showHourDropDown(){if(document.getElementById("hourDropDown").style.display=="block"){document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("hourDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("hourDropDown")}}}function showMinuteDropDown(){if(document.getElementById("minuteDropDown").style.display=="block"){document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame()}else{document.getElementById("minuteDropDown").style.display="block";document.getElementById("monthDropDown").style.display="none";document.getElementById("yearDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";if(MSIE){EIS_FIX_EI1("minuteDropDown")}}}function selectMonth(){document.getElementById("calendar_month_txt").innerHTML=this.innerHTML;currentMonth=this.id.replace(/[^\d]/g,"");document.getElementById("monthDropDown").style.display="none";EIS_Hide_Frame();for(var b=0;b<monthArray.length;b++){document.getElementById("monthDiv_"+b).style.color=""}this.style.color=selectBoxHighlightColor;activeSelectBoxMonth=this;writeCalendarContent()}function selectHour(){document.getElementById("calendar_hour_txt").innerHTML=this.innerHTML;currentHour=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("hourDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxHour){activeSelectBoxHour.style.color=""}activeSelectBoxHour=this;this.style.color=selectBoxHighlightColor}function selectMinute(){document.getElementById("calendar_minute_txt").innerHTML=this.innerHTML;currentMinute=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("minuteDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxMinute){activeSelectBoxMinute.style.color=""}activeSelectBoxMinute=this;this.style.color=selectBoxHighlightColor}function selectYear(){document.getElementById("calendar_year_txt").innerHTML=this.innerHTML;currentYear=this.innerHTML.replace(/[^\d]/g,"");document.getElementById("yearDropDown").style.display="none";EIS_Hide_Frame();if(activeSelectBoxYear){activeSelectBoxYear.style.color=""}activeSelectBoxYear=this;this.style.color=selectBoxHighlightColor;writeCalendarContent()}function switchMonth(){if(this.src.indexOf("left")>=0){currentMonth=currentMonth-1;if(currentMonth<0){currentMonth=11;currentYear=currentYear-1}}else{currentMonth=currentMonth+1;if(currentMonth>11){currentMonth=0;currentYear=currentYear/1+1}}writeCalendarContent()}function createMonthDiv(){var f=document.createElement("DIV");f.className="monthYearPicker";f.id="monthPicker";for(var e=0;e<monthArray.length;e++){var d=document.createElement("DIV");d.innerHTML=monthArray[e];d.onmouseover=highlightMonthYear;d.onmouseout=highlightMonthYear;d.onclick=selectMonth;d.id="monthDiv_"+e;d.style.width="56px";d.onselectstart=cancelCalendarEvent;f.appendChild(d);if(currentMonth&&currentMonth==e){d.style.color=selectBoxHighlightColor;activeSelectBoxMonth=d}}return f}function changeSelectBoxYear(i,g){if(!g){g=this}var h=g.parentNode.getElementsByTagName("DIV");if(g.innerHTML.indexOf("-")>=0){var e=h[1].innerHTML/1-1;if(activeSelectBoxYear){activeSelectBoxYear.style.color=""}}else{var e=h[1].innerHTML/1+1;if(activeSelectBoxYear){activeSelectBoxYear.style.color=""}}for(var j=1;j<h.length-1;j++){h[j].innerHTML=e+j-1;h[j].id="yearDiv"+(e/1+j/1-1)}if(activeSelectBoxYear){activeSelectBoxYear.style.color="";if(document.getElementById("yearDiv"+currentYear)){activeSelectBoxYear=document.getElementById("yearDiv"+currentYear);activeSelectBoxYear.style.color=selectBoxHighlightColor}}}function changeSelectBoxHour(j,e){if(!e){e=this}var h=e.parentNode.getElementsByTagName("DIV");if(e.innerHTML.indexOf("-")>=0){var l=h[1].innerHTML/1-1;if(l<0){l=0}if(activeSelectBoxHour){activeSelectBoxHour.style.color=""}}else{var l=h[1].innerHTML/1+1;if(l>14){l=14}if(activeSelectBoxHour){activeSelectBoxHour.style.color=""}}var i="";for(var k=1;k<h.length-1;k++){if((l/1+k/1)<11){i="0"}else{i=""}h[k].innerHTML=i+(l+k-1);h[k].id="hourDiv"+(l/1+k/1-1)}if(activeSelectBoxHour){activeSelectBoxHour.style.color="";if(document.getElementById("hourDiv"+currentHour)){activeSelectBoxHour=document.getElementById("hourDiv"+currentHour);activeSelectBoxHour.style.color=selectBoxHighlightColor}}}function updateYearDiv(){var f=5;if(turnOffYearSpan){f=0}var h=document.getElementById("yearDropDown");var e=h.getElementsByTagName("DIV");for(var g=1;g<e.length-1;g++){e[g].innerHTML=currentYear/1-f+g;if(currentYear==(currentYear/1-f+g)){e[g].style.color=selectBoxHighlightColor;activeSelectBoxYear=e[g]}else{e[g].style.color=""}}}function updateMonthDiv(){for(no=0;no<12;no++){document.getElementById("monthDiv_"+no).style.color=""}document.getElementById("monthDiv_"+currentMonth).style.color=selectBoxHighlightColor;activeSelectBoxMonth=document.getElementById("monthDiv_"+currentMonth)}function updateHourDiv(){var j=document.getElementById("hourDropDown");var g=j.getElementsByTagName("DIV");var f=0;if((currentHour/1-6+1)<0){f=(currentHour/1-6+1)*-1}for(var i=1;i<g.length-1;i++){var h="";if((currentHour/1-6+i+f)<10){h="0"}g[i].innerHTML=h+(currentHour/1-6+i+f);if(currentHour==(currentHour/1-6+i)){g[i].style.color=selectBoxHighlightColor;activeSelectBoxHour=g[i]}else{g[i].style.color=""}}}function updateMinuteDiv(){for(no=0;no<60;no+=intervalSelectBox_minutes){var b="";if(no<10){b="0"}document.getElementById("minuteDiv_"+b+no).style.color=""}if(document.getElementById("minuteDiv_"+currentMinute)){document.getElementById("minuteDiv_"+currentMinute).style.color=selectBoxHighlightColor;activeSelectBoxMinute=document.getElementById("minuteDiv_"+currentMinute)}}function createYearDiv(){if(!document.getElementById("yearDropDown")){var n=document.createElement("DIV");n.className="monthYearPicker"}else{var n=document.getElementById("yearDropDown");var m=n.getElementsByTagName("DIV");for(var l=0;l<m.length;l++){m[l].parentNode.removeChild(m[l])}}var k=new Date();if(currentYear){k.setFullYear(currentYear)}var d=k.getFullYear()/1-5;var j=10;if(!turnOffYearSpan){var i=document.createElement("DIV");i.innerHTML="&nbsp;&nbsp;- ";i.onclick=changeSelectBoxYear;i.onmouseover=highlightMonthYear;i.onmouseout=function(){selectBoxMovementInProgress=false};i.onselectstart=cancelCalendarEvent;n.appendChild(i)}else{d=k.getFullYear()/1-0;j=2}for(var l=d;l<(d+j);l++){var i=document.createElement("DIV");i.innerHTML=l;i.onmouseover=highlightMonthYear;i.onmouseout=highlightMonthYear;i.onclick=selectYear;i.id="yearDiv"+l;i.onselectstart=cancelCalendarEvent;n.appendChild(i);if(currentYear&&currentYear==l){i.style.color=selectBoxHighlightColor;activeSelectBoxYear=i}}if(!turnOffYearSpan){var i=document.createElement("DIV");i.innerHTML="&nbsp;&nbsp;+ ";i.onclick=changeSelectBoxYear;i.onmouseover=highlightMonthYear;i.onmouseout=function(){selectBoxMovementInProgress=false};i.onselectstart=cancelCalendarEvent;n.appendChild(i)}return n}function slideCalendarSelectBox(){if(selectBoxMovementInProgress){if(activeSelectBox.parentNode.id=="hourDropDown"){changeSelectBoxHour(false,activeSelectBox)}if(activeSelectBox.parentNode.id=="yearDropDown"){changeSelectBoxYear(false,activeSelectBox)}}setTimeout("slideCalendarSelectBox()",speedOfSelectBoxSliding)}function createHourDiv(){if(!document.getElementById("hourDropDown")){var l=document.createElement("DIV");l.className="monthYearPicker"}else{var l=document.getElementById("hourDropDown");var k=l.getElementsByTagName("DIV");for(var j=0;j<k.length;j++){k[j].parentNode.removeChild(k[j])}}if(!currentHour){currentHour=0}var i=currentHour/1;if(i>14){i=14}var g=document.createElement("DIV");g.innerHTML="&nbsp;&nbsp;- ";g.onclick=changeSelectBoxHour;g.onmouseover=highlightMonthYear;g.onmouseout=function(){selectBoxMovementInProgress=false};g.onselectstart=cancelCalendarEvent;l.appendChild(g);for(var j=i;j<i+10;j++){var h="";if(j/1<10){h="0"}var g=document.createElement("DIV");g.innerHTML=h+j;g.onmouseover=highlightMonthYear;g.onmouseout=highlightMonthYear;g.onclick=selectHour;g.id="hourDiv"+j;g.onselectstart=cancelCalendarEvent;l.appendChild(g);if(currentYear&&currentYear==j){g.style.color=selectBoxHighlightColor;activeSelectBoxYear=g}}var g=document.createElement("DIV");g.innerHTML="&nbsp;&nbsp;+ ";g.onclick=changeSelectBoxHour;g.onmouseover=highlightMonthYear;g.onmouseout=function(){selectBoxMovementInProgress=false};g.onselectstart=cancelCalendarEvent;l.appendChild(g);return l}function createMinuteDiv(){if(!document.getElementById("minuteDropDown")){var l=document.createElement("DIV");l.className="monthYearPicker"}else{var l=document.getElementById("minuteDropDown");var k=l.getElementsByTagName("DIV");for(var j=0;j<k.length;j++){k[j].parentNode.removeChild(k[j])}}var g=0;var i="";for(var j=g;j<60;j+=intervalSelectBox_minutes){if(j<10){i="0"}else{i=""}var h=document.createElement("DIV");h.innerHTML=i+j;h.onmouseover=highlightMonthYear;h.onmouseout=highlightMonthYear;h.onclick=selectMinute;h.id="minuteDiv_"+i+j;h.onselectstart=cancelCalendarEvent;l.appendChild(h);if(currentYear&&currentYear==j){h.style.color=selectBoxHighlightColor;activeSelectBoxYear=h}}return l}function highlightSelect(){if(this.className=="selectBoxTime"){this.className="selectBoxTimeOver";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time_over.gif"}else{if(this.className=="selectBoxTimeOver"){this.className="selectBoxTime";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_time.gif"}}if(this.className=="selectBox"){this.className="selectBoxOver";this.getElementsByTagName("IMG")[0].src=pathToImages+"down_over.gif"}else{if(this.className=="selectBoxOver"){this.className="selectBox";this.getElementsByTagName("IMG")[0].src=pathToImages+"down.gif"}}}function highlightArrow(){if(this.src.indexOf("over")>=0){if(this.src.indexOf("left")>=0){this.src=pathToImages+"left.gif"}if(this.src.indexOf("right")>=0){this.src=pathToImages+"right.gif"}}else{if(this.src.indexOf("left")>=0){this.src=pathToImages+"left_over.gif"}if(this.src.indexOf("right")>=0){this.src=pathToImages+"right_over.gif"}}}function highlightClose(){if(this.src.indexOf("over")>=0){this.src=pathToImages+"close.gif"}else{this.src=pathToImages+"close_over.gif"}}function closeCalendar(){document.getElementById("yearDropDown").style.display="none";document.getElementById("monthDropDown").style.display="none";document.getElementById("hourDropDown").style.display="none";document.getElementById("minuteDropDown").style.display="none";calendarDiv.style.display="none";if(iframeObj){iframeObj.style.display="none";EIS_Hide_Frame()}if(activeSelectBoxMonth){activeSelectBoxMonth.className=""}if(activeSelectBoxYear){activeSelectBoxYear.className=""}}function writeTopBar(){var l=document.createElement("DIV");l.className="topBar";l.id="topBar";calendarDiv.appendChild(l);var p=document.createElement("DIV");p.style.marginRight="1px";var m=document.createElement("IMG");m.src=pathToImages+"left.gif";m.onmouseover=highlightArrow;m.onclick=switchMonth;m.onmouseout=highlightArrow;p.appendChild(m);l.appendChild(p);if(Opera){p.style.width="16px"}var r=document.createElement("DIV");r.style.marginRight="1px";var m=document.createElement("IMG");m.src=pathToImages+"right.gif";m.onclick=switchMonth;m.onmouseover=highlightArrow;m.onmouseout=highlightArrow;r.appendChild(m);if(Opera){r.style.width="16px"}l.appendChild(r);var k=document.createElement("DIV");k.id="monthSelect";k.onmouseover=highlightSelect;k.onmouseout=highlightSelect;k.onclick=showMonthDropDown;var q=document.createElement("SPAN");q.innerHTML=monthArray[currentMonth];q.id="calendar_month_txt";k.appendChild(q);var m=document.createElement("IMG");m.src=pathToImages+"down.gif";m.style.position="absolute";m.style.right="0px";k.appendChild(m);k.className="selectBox";if(Opera){m.style.cssText="float:right;position:relative";m.style.position="relative";m.style.styleFloat="right"}l.appendChild(k);var j=createMonthDiv();j.style.left="37px";j.style.top=k.offsetTop+k.offsetHeight+1+"px";j.style.width="60px";j.id="monthDropDown";calendarDiv.appendChild(j);var o=document.createElement("DIV");o.onmouseover=highlightSelect;o.onmouseout=highlightSelect;o.onclick=showYearDropDown;var q=document.createElement("SPAN");q.innerHTML=currentYear;q.id="calendar_year_txt";o.appendChild(q);l.appendChild(o);var m=document.createElement("IMG");m.src=pathToImages+"down.gif";o.appendChild(m);o.className="selectBox";if(Opera){o.style.width="50px";m.style.cssText="float:right";m.style.position="relative";m.style.styleFloat="right"}var n=createYearDiv();n.style.left="113px";n.style.top=k.offsetTop+k.offsetHeight+1+"px";n.style.width="35px";n.id="yearDropDown";calendarDiv.appendChild(n);var m=document.createElement("IMG");m.src=pathToImages+"close.gif";m.style.styleFloat="right";m.onmouseover=highlightClose;m.onmouseout=highlightClose;m.onclick=closeCalendar;l.appendChild(m);if(!document.all){m.style.position="absolute";m.style.right="2px"}}function writeCalendarContent(){var p=true;if(!calendarContentDiv){calendarContentDiv=document.createElement("DIV");calendarDiv.appendChild(calendarContentDiv);p=false}currentMonth=currentMonth/1;var t=new Date();t.setFullYear(currentYear);t.setDate(1);t.setMonth(currentMonth);var q=t.getDay();if(!weekStartsOnSunday){if(q==0){q=7}q--}document.getElementById("calendar_year_txt").innerHTML=currentYear;document.getElementById("calendar_month_txt").innerHTML=monthArray[currentMonth];document.getElementById("calendar_hour_txt").innerHTML=currentHour/1>9?currentHour:"0"+currentHour;document.getElementById("calendar_minute_txt").innerHTML=currentMinute/1>9?currentMinute:"0"+currentMinute;var d=calendarContentDiv.getElementsByTagName("TABLE");if(d.length>0){calendarContentDiv.removeChild(d[0])}var s=document.createElement("TABLE");s.width="100%";s.cellSpacing="0";calendarContentDiv.appendChild(s);var r=document.createElement("TBODY");s.appendChild(r);var x=r.insertRow(-1);x.className="calendar_week_row";if(showWeekNumber){var u=x.insertCell(-1);u.innerHTML=weekString;u.className="calendar_week_column";u.style.backgroundColor=selectBoxRolloverBgColor}for(var v=0;v<dayArray.length;v++){var u=x.insertCell(-1);u.innerHTML=dayArray[v]}var x=r.insertRow(-1);if(showWeekNumber){var u=x.insertCell(-1);u.className="calendar_week_column";u.style.backgroundColor=selectBoxRolloverBgColor;var o=getWeek(currentYear,currentMonth,1);u.innerHTML=o}for(var v=0;v<q;v++){var u=x.insertCell(-1);u.innerHTML="&nbsp;"}var w=q;var n=daysInMonthArray[currentMonth];if(n==28){if(isLeapYear(currentYear)){n=29}}for(var v=1;v<=n;v++){t.setDate(v-1);if(w>0&&w%7==0){var x=r.insertRow(-1);if(showWeekNumber){var u=x.insertCell(-1);u.className="calendar_week_column";var o=getWeek(currentYear,currentMonth,v);u.innerHTML=o;u.style.backgroundColor=selectBoxRolloverBgColor}}var u=x.insertCell(-1);if(currentYear==inputYear&&currentMonth==inputMonth&&v==inputDay){u.className="activeDay"}u.innerHTML=v;u.onclick=pickDate;w++}if(!document.all){if(calendarContentDiv.offsetHeight){document.getElementById("topBar").style.top=calendarContentDiv.offsetHeight+document.getElementById("timeBar").offsetHeight+document.getElementById("topBar").offsetHeight-1+"px"}else{document.getElementById("topBar").style.top="";document.getElementById("topBar").style.bottom="0px"}}if(iframeObj){if(!p){setTimeout("resizeIframe()",350)}else{setTimeout("resizeIframe()",10)}}}function resizeIframe(){iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj.style.height=calendarDiv.offsetHeight+"px"}function pickTodaysDate(){var b=new Date();currentMonth=b.getMonth();currentYear=b.getFullYear();pickDate(false,b.getDate())}function pickDate(i,h){var g=currentMonth/1+1;if(g<10){g="0"+g}var e;if(!h&&this){e=this.innerHTML}else{e=h}if(e/1<10){e="0"+e}if(returnFormat){returnFormat=returnFormat.replace("dd",e);returnFormat=returnFormat.replace("mm",g);returnFormat=returnFormat.replace("yyyy",currentYear);returnFormat=returnFormat.replace("hh",currentHour);returnFormat=returnFormat.replace("ii",currentMinute);returnFormat=returnFormat.replace("d",e/1);returnFormat=returnFormat.replace("m",g/1);returnDateTo.value=returnFormat;try{returnDateTo.onchange()}catch(i){}}else{for(var j=0;j<returnDateToYear.options.length;j++){if(returnDateToYear.options[j].value==currentYear){returnDateToYear.selectedIndex=j;break}}for(var j=0;j<returnDateToMonth.options.length;j++){if(returnDateToMonth.options[j].value==parseFloat(g)){returnDateToMonth.selectedIndex=j;break}}for(var j=0;j<returnDateToDay.options.length;j++){if(returnDateToDay.options[j].value==parseFloat(e)){returnDateToDay.selectedIndex=j;break}}if(calendarDisplayTime){for(var j=0;j<returnDateToHour.options.length;j++){if(returnDateToHour.options[j].value==parseFloat(currentHour)){returnDateToHour.selectedIndex=j;break}}for(var j=0;j<returnDateToMinute.options.length;j++){if(returnDateToMinute.options[j].value==parseFloat(currentMinute)){returnDateToMinute.selectedIndex=j;break}}}}closeCalendar()}function getWeek(o,m,q){if(!weekStartsOnSunday){q=(q/1)}else{q=(q/1)+1}o=o/1;m=m/1+1;var r=Math.floor((14-(m))/12);var p=o+4800-r;var l=(m)+(12*r)-3;var s=q+Math.floor(((153*l)+2)/5)+(365*p)+Math.floor(p/4)-Math.floor(p/100)+Math.floor(p/400)-32045;var t=(s+31741-(s%7))%146097%36524%1461;var n=Math.floor(t/1460);var a=((t-n)%365)+n;NumberOfWeek=Math.floor(a/7)+1;return NumberOfWeek}function writeTimeBar(){var n=document.createElement("DIV");n.id="timeBar";n.className="timeBar";var l=document.createElement("DIV");l.innerHTML="Time:";var i=document.createElement("DIV");i.onmouseover=highlightSelect;i.onmouseout=highlightSelect;i.onclick=showHourDropDown;i.style.width="30px";var m=document.createElement("SPAN");m.innerHTML=currentHour;m.id="calendar_hour_txt";i.appendChild(m);n.appendChild(i);var j=document.createElement("IMG");j.src=pathToImages+"down_time.gif";i.appendChild(j);i.className="selectBoxTime";if(Opera){i.style.width="30px";j.style.cssText="float:right";j.style.position="relative";j.style.styleFloat="right"}var k=createHourDiv();k.style.left="130px";k.style.width="35px";k.id="hourDropDown";calendarDiv.appendChild(k);var p=document.createElement("DIV");p.onmouseover=highlightSelect;p.onmouseout=highlightSelect;p.onclick=showMinuteDropDown;p.style.width="30px";var m=document.createElement("SPAN");m.innerHTML=currentMinute;m.id="calendar_minute_txt";p.appendChild(m);n.appendChild(p);var j=document.createElement("IMG");j.src=pathToImages+"down_time.gif";p.appendChild(j);p.className="selectBoxTime";if(Opera){p.style.width="30px";j.style.cssText="float:right";j.style.position="relative";j.style.styleFloat="right"}var o=createMinuteDiv();o.style.left="167px";o.style.width="35px";o.id="minuteDropDown";calendarDiv.appendChild(o);return n}function writeBottomBar(){var k=new Date();var j=document.createElement("DIV");j.id="bottomBar";j.style.cursor="pointer";j.className="todaysDate";var i=document.createElement("DIV");i.onclick=pickTodaysDate;i.id="todaysDateString";i.style.width=(calendarDiv.offsetWidth-95)+"px";var h=k.getDay();if(!weekStartsOnSunday){if(h==0){h=7}h--}var d=todayStringFormat;d=d.replace("[monthString]",monthArrayShort[k.getMonth()]);d=d.replace("[day]",k.getDate());d=d.replace("[year]",k.getFullYear());d=d.replace("[dayString]",dayArray[h].toLowerCase());d=d.replace("[UCFdayString]",dayArray[h]);d=d.replace("[todayString]",todayString);i.innerHTML=todayString+": "+k.getDate()+". "+monthArrayShort[k.getMonth()]+", "+k.getFullYear();i.innerHTML=d;j.appendChild(i);var l=writeTimeBar();j.appendChild(l);calendarDiv.appendChild(j)}function getTopPos(c){var d=c.offsetTop+c.offsetHeight;while((c=c.offsetParent)!=null){d+=c.offsetTop}return d+calendar_offsetTop}function getleftPos(c){var d=c.offsetLeft;while((c=c.offsetParent)!=null){d+=c.offsetLeft}return d+calendar_offsetLeft}function positionCalendar(b){calendarDiv.style.left=getleftPos(b)+"px";calendarDiv.style.top=getTopPos(b)+"px";if(iframeObj){iframeObj.style.left=calendarDiv.style.left;iframeObj.style.top=calendarDiv.style.top;iframeObj2.style.left=calendarDiv.style.left;iframeObj2.style.top=calendarDiv.style.top}}function initCalendar(){if(MSIE){iframeObj=document.createElement("IFRAME");iframeObj.style.filter="alpha(opacity=0)";iframeObj.style.position="absolute";iframeObj.border="0px";iframeObj.style.border="0px";iframeObj.style.backgroundColor="#FF0000";iframeObj2=document.createElement("IFRAME");iframeObj2.style.position="absolute";iframeObj2.border="0px";iframeObj2.style.border="0px";iframeObj2.style.height="1px";iframeObj2.style.width="1px";iframeObj2.src="blank.html";iframeObj.src="blank.html";document.body.appendChild(iframeObj2);document.body.appendChild(iframeObj)}calendarDiv=document.createElement("DIV");calendarDiv.id="calendarDiv";calendarDiv.style.zIndex=1000;slideCalendarSelectBox();document.body.appendChild(calendarDiv);writeBottomBar();writeTopBar();if(!currentYear){var b=new Date();currentMonth=b.getMonth();currentYear=b.getFullYear()}writeCalendarContent()}function setTimeProperties(){if(!calendarDisplayTime){document.getElementById("timeBar").style.display="none";document.getElementById("timeBar").style.visibility="hidden";document.getElementById("todaysDateString").style.width="100%"}else{document.getElementById("timeBar").style.display="block";document.getElementById("timeBar").style.visibility="visible";document.getElementById("hourDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.top=document.getElementById("calendar_minute_txt").parentNode.offsetHeight+calendarContentDiv.offsetHeight+document.getElementById("topBar").offsetHeight+"px";document.getElementById("minuteDropDown").style.right="50px";document.getElementById("hourDropDown").style.right="50px";document.getElementById("todaysDateString").style.width="115px"}}function calendarSortItems(b,a){return b/1-a/1}function displayDOB(f,e,d){if(f.value==""){f.value="01-01-1990"}displayCalendar(f,e,d)}function displayCalendar(v,F,t,H,i){if(H){calendarDisplayTime=true}else{calendarDisplayTime=false}if(v.value.length>6){if(!v.value.match(/^[0-9]*?$/gi)){var E=v.value.split(/[^0-9]/gi);var B=new Object();B.m=F.indexOf("mm");if(B.m==-1){B.m=F.indexOf("m")}B.d=F.indexOf("dd");if(B.d==-1){B.d=F.indexOf("d")}B.y=F.indexOf("yyyy");B.h=F.indexOf("hh");B.i=F.indexOf("ii");this.initialHour="00";this.initialMinute="00";var d=["y","m","d","h","i"];var D=["currentYear","currentMonth","inputDay","currentHour","currentMinute"];var x=[4,2,2,2,2];for(var z=0;z<d.length;z++){if(B[d[z]]>=0){window[D[z]]=v.value.substr(B[d[z]],x[z])/1}}currentMonth--}else{var G=F.indexOf("mm");currentMonth=v.value.substr(G,2)/1-1;var w=F.indexOf("yyyy");currentYear=v.value.substr(w,4);var A=F.indexOf("dd");tmpDay=v.value.substr(A,2);var y=F.indexOf("hh");if(y>=0){tmpHour=v.value.substr(y,2);currentHour=tmpHour;if(currentHour.length==1){currentHour="0"}}else{currentHour="00"}var u=F.indexOf("ii");if(u>=0){tmpMinute=v.value.substr(u,2);currentMinute=tmpMinute}else{currentMinute="00"}}}else{var C=new Date();currentMonth=C.getMonth();currentYear=C.getFullYear();currentHour="08";currentMinute="00";inputDay=C.getDate()/1}inputYear=currentYear;inputMonth=currentMonth;if(!calendarDiv){initCalendar()}else{if(calendarDiv.style.display=="block"){closeCalendar();return false}writeCalendarContent()}returnFormat=F;returnDateTo=v;positionCalendar(t);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height="140px";iframeObj.style.width="195px";iframeObj2.style.display="";iframeObj2.style.height="140px";iframeObj2.style.width="195px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateMinuteDiv();updateHourDiv()}function displayCalendarSelectBox(k,l,j,i,h,g){if(!i){calendarDisplayTime=false}else{calendarDisplayTime=true}currentMonth=l.options[l.selectedIndex].value/1-1;currentYear=k.options[k.selectedIndex].value;if(i){currentHour=i.options[i.selectedIndex].value;inputHour=currentHour/1}if(h){currentMinute=h.options[h.selectedIndex].value;inputMinute=currentMinute/1}inputYear=k.options[k.selectedIndex].value;inputMonth=l.options[l.selectedIndex].value/1-1;inputDay=j.options[j.selectedIndex].value/1;if(!calendarDiv){initCalendar()}else{writeCalendarContent()}returnDateToYear=k;returnDateToMonth=l;returnDateToDay=j;returnDateToHour=i;returnDateToMinute=h;returnFormat=false;returnDateTo=false;positionCalendar(g);calendarDiv.style.visibility="visible";calendarDiv.style.display="block";if(iframeObj){iframeObj.style.display="";iframeObj.style.height=calendarDiv.offsetHeight+"px";iframeObj.style.width=calendarDiv.offsetWidth+"px";iframeObj2.style.display="";iframeObj2.style.height=calendarDiv.offsetHeight+"px";iframeObj2.style.width=calendarDiv.offsetWidth+"px"}setTimeProperties();updateYearDiv();updateMonthDiv();updateHourDiv();updateMinuteDiv()};